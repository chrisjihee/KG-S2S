(KG-S2S) dlt@dl012:~/proj/KG-S2S$ export CUDA_VISIBLE_DEVICES=7
(KG-S2S) dlt@dl012:~/proj/KG-S2S$ setting-korean/train-FB15k-237N-ko-KeT5-2.sh
Namespace(dataset_path='./data/processed', dataset='FB15k-237N-ko', model='T5Finetuner', strategy='auto', precision='bf16', accelerator='gpu', seed=41504, num_workers=4, save_dir='./checkpoint/FB15k-237N-ko-2023-12-12 01:28:56.424525', pretrained_model='KETI-AIR/ke-t5-base-ko', batch_size=16, val_batch_size=16, num_beams=40, num_beam_groups=1, src_max_length=512, train_tgt_max_length=512, eval_tgt_max_length=90, epochs=3, lr=0.0005, diversity_penalty=0.0, model_path='', optim='Adam', decoder='beam_search', log_text=False, use_prefix_search=False, src_descrip_max_length=240, tgt_descrip_max_length=240, use_soft_prompt=True, use_rel_prompt_emb=True, skip_n_val_epoch=0, seq_dropout=0.2, temporal=False, n_ent=12068, n_rel=90, vocab_size=64128, model_dim=768)
Global seed set to 41504
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
tokenizing entities...
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12068/12068 [00:32<00:00, 375.31it/s]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
datamodule construction done.

----------------------------------------------------------------------------------
 * pl.Trainer(accelerator=gpu, precision=bf16, strategy=auto)
----------------------------------------------------------------------------------

Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
model construction done.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [7]

  | Name          | Type                               | Params
---------------------------------------------------------------------
0 | core_t5_model | ModifiedT5ForConditionalGeneration | 247 M
1 | rel_embed1    | Embedding                          | 69.1 K
2 | rel_embed2    | Embedding                          | 69.1 K
3 | rel_embed3    | Embedding                          | 69.1 K
4 | rel_embed4    | Embedding                          | 69.1 K
---------------------------------------------------------------------
247 M     Trainable params
0         Non-trainable params
247 M     Total params
991.024   Total estimated model params size (MB)
Training: 0it [00:00, ?it/s]Epoch:    0,
Epoch 0:  93%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 9138/9866 [24:22<01:56,  6.25it/s, loss=0.692]Training time: 1462s
Epoch 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 9866/9866 [2:14:32<00:00,  1.22it/s, loss=0.692]
                   mrr           mr   hit@1   hit@3  hit@10█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 364/364 [55:07<00:00,  9.09s/it]
tail ranking  0.375706  2812.179425  31.09%  41.63%  50.95%
head ranking  0.090713  4996.079649   6.66%  10.10%  14.66%
mean ranking  0.233209  3904.129537  18.87%  25.86%  32.81%
Ellipsis
Validation time: 6610s
Epoch 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 9866/9866 [2:14:32<00:00,  1.22it/s, loss=0.692]
Total time: 8072s, loss: 1.3095
--------------------------------------------------
Epoch 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 9866/9866 [2:14:32<00:00,  1.22it/s, loss=0.692]Epoch:    1,
Epoch 1:  93%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 9138/9866 [24:09<01:55,  6.31it/s, loss=0.421]Training time: 1449s
Epoch 1:  98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉    | 9703/9866 [1:49:50<01:50,  1.47it/s, loss=0.421]
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 9866/9866 [2:14:09<00:00,  1.23it/s, loss=0.421]
                   mrr           mr   hit@1   hit@3  hit@10█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 364/364 [54:40<00:00,  9.01s/it]
tail ranking  0.390878  2508.001204  31.70%  43.32%  53.00%
head ranking  0.093769  4908.992087   6.73%  10.22%  14.91%
mean ranking  0.242324  3708.496645  19.22%  26.77%  33.96%
Ellipsis
Validation time: 6599s
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 9866/9866 [2:14:09<00:00,  1.23it/s, loss=0.421]
Total time: 8049s, loss: 0.5469
--------------------------------------------------
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 9866/9866 [2:14:09<00:00,  1.23it/s, loss=0.421]Epoch:    2,
Epoch 2:  93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                  | 9138/9866 [24:10<01:55,  6.30it/s, loss=0.339]Training time: 1450s
Epoch 2: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 9866/9866 [2:15:25<00:00,  1.21it/s, loss=0.339]
                   mrr           mr   hit@1   hit@3  hit@10█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 364/364 [55:10<00:00,  9.09s/it]
tail ranking  0.409653  2272.089627  33.56%  44.97%  55.70%
head ranking  0.116953  4676.804060   9.05%  12.15%  17.58%
mean ranking  0.263303  3474.446843  21.31%  28.56%  36.64%
Ellipsis
Validation time: 6675s
Epoch 2: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 9866/9866 [2:15:25<00:00,  1.21it/s, loss=0.339]
Total time: 8125s, loss: 0.3431
--------------------------------------------------
Epoch 2: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 9866/9866 [2:15:25<00:00,  1.21it/s, loss=0.339]`Trainer.fit` stopped: `max_epochs=3` reached.
Epoch 2: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 9866/9866 [2:15:44<00:00,  1.21it/s, loss=0.339]
model_path: [./checkpoint/FB15k-237N-ko-2023-12-12 01:28:56.424525/FB15k-237N-ko-epoch=002-val_mrr=0.2633.ckpt]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [7]
Testing DataLoader 1: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 423/423 [58:05<00:00,  8.24s/it]
                   mrr           mr   hit@1   hit@3  hit@10
tail ranking  0.403204  2355.715469  33.24%  44.11%  54.79%
head ranking  0.119002  4640.892931   9.12%  12.56%  17.98%
mean ranking  0.261103  3498.304200  21.18%  28.33%  36.39%

==================================================
Epoch: test
Ellipsis
==================================================
Testing DataLoader 1: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 423/423 [58:05<00:00,  8.24s/it]
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Runningstage.testing metric      DataLoader 0             DataLoader 1
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
         val_mrr            0.2611028254032135       0.2611028254032135
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
(KG-S2S) dlt@dl012:~/proj/KG-S2S$

