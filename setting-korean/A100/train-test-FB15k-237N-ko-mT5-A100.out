(KG-S2S) dlt@dl012:~/proj/KG-S2S$ bash setting-korean/train-FB15k-237N-ko-MT5-2.sh
Namespace(dataset_path='./data/processed', dataset='FB15k-237N-ko', model='T5Finetuner', gpu='4', seed=41504, num_workers=4, save_dir='./checkpoint/FB15k-237N-ko-2023-12-11 20:24:06.205586', pretrained_model='google/mt5-base', batch_size=16, val_batch_size=8, num_beams=40, num_beam_groups=1, src_max_length=512, train_tgt_max_length=512, eval_tgt_max_length=90, epochs=1, lr=0.001, diversity_penalty=0.0, model_path='', optim='Adam', decoder='beam_search', log_text=False, use_prefix_search=False, src_descrip_max_length=240, tgt_descrip_max_length=240, use_soft_prompt=True, use_rel_prompt_emb=True, skip_n_val_epoch=0, seq_dropout=0.2, temporal=False, n_ent=12068, n_rel=90, vocab_size=250112, model_dim=768)
Global seed set to 41504
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
tokenizing entities...
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12068/12068 [00:32<00:00, 366.99it/s]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
datamodule construction done.

----------------------------------------------------------------------------------
 * pl.Trainer(accelerator=gpu, devices=[4])
----------------------------------------------------------------------------------

GPU available: True, used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
model construction done.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3,4,5,6,7]

  | Name          | Type                                | Params
----------------------------------------------------------------------
0 | core_t5_model | ModifiedMT5ForConditionalGeneration | 582 M
1 | rel_embed1    | Embedding                           | 69.1 K
2 | rel_embed2    | Embedding                           | 69.1 K
3 | rel_embed3    | Embedding                           | 69.1 K
4 | rel_embed4    | Embedding                           | 69.1 K
----------------------------------------------------------------------
582 M     Trainable params
0         Non-trainable params
582 M     Total params
2,330.711 Total estimated model params size (MB)
Training: 0it [00:00, ?it/s]Epoch:    0,
Epoch 0:  86%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                  | 9138/10592 [27:13<04:19,  5.59it/s, loss=0.432]Training time: 1633s
Epoch 0:  95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉             | 10026/10592 [1:47:38<06:04,  1.55it/s, loss=0.432]
Epoch 0:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎        | 10027/10592 [1:47:44<06:04,  1.55it/s, loss=0.432]Epoch 0:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎        | 10027/10592 [1:47:44<06:04,  1.55it/s, loss=0.432]
Epoch 0:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎        | 10034/10592 [1:48:25<06:01,  1.54it/s, loss=0.432]
Epoch 0:  95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍        | 10037/10592 [1:48:42<06:00,  1.54it/s, loss=0.432]
Epoch 0: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10592/10592 [2:40:06<00:00,  1.10it/s, loss=0.432]
                   mrr           mr  hit@1  hit@3 hit@10██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 727/727 [1:07:12<00:00,  5.20s/it]
tail ranking  0.065542  4551.077757  4.59%  5.52%  8.70%
head ranking  0.015721  5883.306898  1.29%  1.60%  2.00%
mean ranking  0.040631  5217.192328  2.94%  3.56%  5.35%
Ellipsis
Validation time: 7972s
Epoch 0: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10592/10592 [2:40:06<00:00,  1.10it/s, loss=0.432]
Total time: 9606s, loss: 0.8008
--------------------------------------------------
Epoch 0: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 10592/10592 [2:40:35<00:00,  1.10it/s, loss=0.432]
model_path: [./checkpoint/FB15k-237N-ko-2023-12-11 20:24:06.205586/FB15k-237N-ko-epoch=000-val_mrr=0.0406.ckpt]
(KG-S2S) dlt@dl012:~/proj/KG-S2S$

