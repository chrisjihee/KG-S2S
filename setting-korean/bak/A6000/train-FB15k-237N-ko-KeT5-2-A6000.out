(KG-S2S) chrisjihee@ptlm3:~/proj/KG-S2S$ setting-korean/train-FB15k-237N-ko-KeT5-2.sh
Namespace(dataset_path='./data/processed', dataset='FB15k-237N-ko', model='T5Finetuner', strategy='auto', precision='bf16', accelerator='gpu', seed=41504, num_workers=4, save_dir='./checkpoint/FB15k-237N-ko-2023-12-12 01:23:54.345199', pretrained_model='KETI-AIR/ke-t5-base-ko', batch_size=16, val_batch_size=16, num_beams=40, num_beam_groups=1, src_max_length=512, train_tgt_max_length=512, eval_tgt_max_length=90, epochs=3, lr=0.0005, diversity_penalty=0.0, model_path='', optim='Adam', decoder='beam_search', log_text=False, use_prefix_search=False, src_descrip_max_length=240, tgt_descrip_max_length=240, use_soft_prompt=True, use_rel_prompt_emb=True, skip_n_val_epoch=0, seq_dropout=0.2, temporal=False, n_ent=12068, n_rel=90, vocab_size=64128, model_dim=768)
Global seed set to 41504
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
tokenizing entities...
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12068/12068 [00:28<00:00, 419.43it/s]
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
datamodule construction done.

----------------------------------------------------------------------------------
 * pl.Trainer(accelerator=gpu, precision=bf16, strategy=auto)
----------------------------------------------------------------------------------

Using bfloat16 Automatic Mixed Precision (AMP)
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
model construction done.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]

  | Name          | Type                               | Params
---------------------------------------------------------------------
0 | core_t5_model | ModifiedT5ForConditionalGeneration | 247 M
1 | rel_embed1    | Embedding                          | 69.1 K
2 | rel_embed2    | Embedding                          | 69.1 K
3 | rel_embed3    | Embedding                          | 69.1 K
4 | rel_embed4    | Embedding                          | 69.1 K
---------------------------------------------------------------------
247 M     Trainable params
0         Non-trainable params
247 M     Total params
991.024   Total estimated model params size (MB)
Training: 0it [00:00, ?it/s]Epoch:    0,
Epoch 0:  93%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 9138/9866 [22:38<01:48,  6.72it/s, loss=0.694]Training time: 1358s
Epoch 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 9866/9866 [1:48:12<00:00,  1.52it/s, loss=0.694]
                   mrr           mr   hit@1   hit@3  hit@10█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 364/364 [42:36<00:00,  7.02s/it]
tail ranking  0.376158  2834.948047  31.07%  42.03%  50.68%
head ranking  0.089612  5021.240151   6.61%   9.75%  14.66%
mean ranking  0.232885  3928.094099  18.84%  25.89%  32.67%
Ellipsis
Validation time: 5134s
Epoch 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 9866/9866 [1:48:12<00:00,  1.52it/s, loss=0.694]
Total time: 6492s, loss: 1.3059
--------------------------------------------------
Epoch 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 9866/9866 [1:48:12<00:00,  1.52it/s, loss=0.694]Epoch:    1,
Epoch 1:  93%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 9138/9866 [22:39<01:48,  6.72it/s, loss=0.409]Training time: 1360s
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 9866/9866 [1:48:42<00:00,  1.51it/s, loss=0.409]
                   mrr           mr   hit@1   hit@3  hit@10█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 364/364 [43:47<00:00,  7.22s/it]
tail ranking  0.397856  2501.104421  32.53%  44.25%  53.90%
head ranking  0.099223  4862.297437   7.17%  10.96%  15.53%
mean ranking  0.248540  3681.700929  19.85%  27.60%  34.72%
Ellipsis
Validation time: 5162s
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 9866/9866 [1:48:42<00:00,  1.51it/s, loss=0.409]
Total time: 6522s, loss: 0.5377
--------------------------------------------------
Epoch 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 9866/9866 [1:48:42<00:00,  1.51it/s, loss=0.409]Epoch:    2,
Epoch 2:  93%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 9138/9866 [22:44<01:48,  6.70it/s, loss=0.343]Training time: 1364s
Epoch 2:  93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████           | 9222/9866 [32:32<02:16,  4.72it/s, loss=0.343]
Epoch 2:  93%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 9223/9866 [32:40<02:16,  4.70it/s, loss=0.343]
Epoch 2:  93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████           | 9224/9866 [32:47<02:16,  4.69it/s, loss=0.343]
Epoch 2: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 9866/9866 [1:48:46<00:00,  1.51it/s, loss=0.343]
                   mrr           mr   hit@1   hit@3  hit@10█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 364/364 [43:14<00:00,  7.13s/it]
tail ranking  0.402421  2289.718906  32.94%  44.13%  55.41%
head ranking  0.109376  4700.058834   8.14%  11.39%  16.96%
mean ranking  0.255898  3494.888870  20.54%  27.76%  36.19%
Ellipsis
Validation time: 5161s
Epoch 2: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 9866/9866 [1:48:46<00:00,  1.51it/s, loss=0.343]
Total time: 6526s, loss: 0.3449
--------------------------------------------------
Epoch 2: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 9866/9866 [1:48:46<00:00,  1.51it/s, loss=0.343]`Trainer.fit` stopped: `max_epochs=3` reached.
Epoch 2: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 9866/9866 [1:48:59<00:00,  1.51it/s, loss=0.343]
model_path: [./checkpoint/FB15k-237N-ko-2023-12-12 01:23:54.345199/FB15k-237N-ko-epoch=002-val_mrr=0.2559.ckpt]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Testing DataLoader 1: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 423/423 [45:14<00:00,  6.42s/it]
                   mrr           mr   hit@1   hit@3  hit@10
tail ranking  0.396035  2370.609287  32.36%  43.76%  54.13%
head ranking  0.113679  4675.919107   8.41%  12.17%  17.73%
mean ranking  0.254857  3523.264197  20.39%  27.97%  35.93%

==================================================
Epoch: test
Ellipsis
==================================================
Testing DataLoader 1: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 423/423 [45:14<00:00,  6.42s/it]
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
Runningstage.testing metric      DataLoader 0             DataLoader 1
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
         val_mrr            0.2548573315143585       0.2548573315143585
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
(KG-S2S) chrisjihee@ptlm3:~/proj/KG-S2S$

