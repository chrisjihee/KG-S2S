(KG-S2S) dlt@dl012:~/proj/KG-S2S$ bash setting-paper/train-NELL.sh
Namespace(dataset_path='./data/processed', dataset='NELL', model='T5Finetuner', gpu='7', seed=41504, num_workers=4, save_dir='./checkpoint/NELL-2023-12-07 23:18:18.540638', pretrained_model='t5-base', batch_size=128, val_batch_size=8, num_beams=40, num_beam_groups=1, src_max_length=512, train_tgt_max_length=512, eval_tgt_max_length=25, epochs=30, lr=0.0005, diversity_penalty=0.0, model_path='', optim='Adam', decoder='beam_search', log_text=False, use_prefix_search=False, src_descrip_max_length=0, tgt_descrip_max_length=0, use_soft_prompt=True, use_rel_prompt_emb=True, skip_n_val_epoch=0, seq_dropout=0.0, temporal=False, n_ent=68544, n_rel=358, vocab_size=32128, model_dim=768)
Global seed set to 41504
tokenizing entities...
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 68544/68544 [00:21<00:00, 3120.61it/s]
datamodule construction done.

----------------------------------------------------------------------------------
 * pl.Trainer(accelerator=gpu, devices=[7])
----------------------------------------------------------------------------------

GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
model construction done.
You are using a CUDA device ('NVIDIA A100-PCIE-40GB') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3,4,5,6,7]

  | Name                       | Type                               | Params
----------------------------------------------------------------------------------
0 | T5ForConditionalGeneration | ModifiedT5ForConditionalGeneration | 222 M
1 | rel_embed1                 | Embedding                          | 274 K
2 | rel_embed2                 | Embedding                          | 274 K
3 | rel_embed3                 | Embedding                          | 274 K
4 | rel_embed4                 | Embedding                          | 274 K
----------------------------------------------------------------------------------
224 M     Trainable params
0         Non-trainable params
224 M     Total params
896.013   Total estimated model params size (MB)
Training: 0it [00:00, ?it/s]
Epoch    0,
Epoch 0:  92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊             | 2964/3216 [14:58<01:16,  3.30it/s, loss=0.578]
Training time:  898s
Epoch 0: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:41<00:00,  2.72it/s, loss=0.578]
                   mrr            mr  hit@1   hit@3   hit@5  hit@10
tail ranking  0.137336  22875.399402  8.17%  15.94%  19.72%  26.49%
head ranking  0.186791  17606.784861  8.57%  23.61%  31.27%  40.24%
mean ranking  0.162064  20241.092131  8.37%  19.77%  25.50%  33.37%
Ellipsis
Validation time:  283s
Epoch 0: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:41<00:00,  2.72it/s, loss=0.578]
Total time: 1181s, loss: 0.6399
--------------------------------------------------
Epoch 0: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:41<00:00,  2.72it/s, loss=0.578]
Epoch    1,
Epoch 1:  92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊             | 2964/3216 [14:59<01:16,  3.29it/s, loss=0.489]
Training time:  900s
Epoch 1: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:33<00:00,  2.74it/s, loss=0.489]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.134870  20333.661355   7.47%  15.04%  19.72%  28.49%
head ranking  0.214228  17214.551793  13.84%  23.80%  29.38%  40.54%
mean ranking  0.174549  18774.106574  10.66%  19.42%  24.55%  34.51%
Ellipsis
Validation time:  273s
Epoch 1: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:33<00:00,  2.74it/s, loss=0.489]
Total time: 1173s, loss: 0.5133
--------------------------------------------------
Epoch 1: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:33<00:00,  2.74it/s, loss=0.489]
Epoch    2,
Epoch 2:  92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊             | 2964/3216 [14:59<01:16,  3.30it/s, loss=0.465]
Training time:  899s
Epoch 2: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:31<00:00,  2.74it/s, loss=0.465]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.159134  21394.986056  10.26%  18.03%  22.61%  30.08%
head ranking  0.234781  15621.695219  13.84%  29.08%  34.76%  43.33%
mean ranking  0.196958  18508.340637  12.05%  23.56%  28.69%  36.70%
Ellipsis
Validation time:  272s
Epoch 2: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:31<00:00,  2.74it/s, loss=0.465]
Total time: 1171s, loss: 0.4547
--------------------------------------------------
Epoch 2: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:31<00:00,  2.74it/s, loss=0.465]
Epoch    3,
Epoch 3:  92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊             | 2964/3216 [15:00<01:16,  3.29it/s, loss=0.425]
Training time:  900s
Epoch 3: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:39<00:00,  2.73it/s, loss=0.425]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.170118  19660.977092  10.96%  18.73%  23.41%  31.18%
head ranking  0.223753  15776.397410  13.75%  25.30%  30.78%  43.23%
mean ranking  0.196935  17718.687251  12.35%  22.01%  27.09%  37.20%
Ellipsis
Validation time:  278s
Epoch 3: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:39<00:00,  2.73it/s, loss=0.425]
Total time: 1179s, loss: 0.4138
--------------------------------------------------
Epoch 3: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:39<00:00,  2.73it/s, loss=0.425]
Epoch    4,
Epoch 4:  92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊             | 2964/3216 [14:57<01:16,  3.30it/s, loss=0.381]
Training time:  897s
Epoch 4: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:35<00:00,  2.74it/s, loss=0.381]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.167381  19877.755976  10.26%  19.82%  24.50%  31.27%
head ranking  0.215170  18178.367530  14.84%  23.80%  28.78%  37.45%
mean ranking  0.191276  19028.061753  12.55%  21.81%  26.64%  34.36%
Ellipsis
Validation time:  277s
Epoch 4: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:35<00:00,  2.74it/s, loss=0.381]
Total time: 1175s, loss: 0.3815
--------------------------------------------------
Epoch 4: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:35<00:00,  2.74it/s, loss=0.381]
Epoch    5,
Epoch 5:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊             | 2964/3216 [14:57<01:16,  3.30it/s, loss=0.36]
Training time:  898s
Epoch 5: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:43<00:00,  2.72it/s, loss=0.36]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.170222  21023.757968  10.56%  19.72%  23.90%  30.38%
head ranking  0.262773  17016.616534  19.52%  28.19%  33.47%  41.73%
mean ranking  0.216497  19020.187251  15.04%  23.95%  28.69%  36.06%
Ellipsis
Validation time:  284s
Epoch 5: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:43<00:00,  2.72it/s, loss=0.36]
Total time: 1183s, loss: 0.3547
--------------------------------------------------
Epoch 5: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:43<00:00,  2.72it/s, loss=0.36]
Epoch    6,
Epoch 6:  92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊             | 2964/3216 [14:57<01:16,  3.30it/s, loss=0.325]
Training time:  898s
Epoch 6: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:36<00:00,  2.73it/s, loss=0.325]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.187066  19536.261952  12.05%  21.61%  26.39%  32.07%
head ranking  0.243926  16223.704183  16.33%  27.79%  34.06%  41.63%
mean ranking  0.215496  17879.983068  14.19%  24.70%  30.23%  36.85%
Ellipsis
Validation time:  278s
Epoch 6: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:36<00:00,  2.73it/s, loss=0.325]
Total time: 1176s, loss: 0.3327
--------------------------------------------------
Epoch 6: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:36<00:00,  2.73it/s, loss=0.325]
Epoch    7,
Epoch 7:  92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                   | 2964/3216 [14:54<01:16,  3.31it/s, loss=0.311]
Training time:  894s
Epoch 7: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:39<00:00,  2.73it/s, loss=0.311]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.177882  19265.428287  11.35%  20.32%  25.10%  31.97%
head ranking  0.259240  16725.761952  17.83%  29.58%  35.36%  43.73%
mean ranking  0.218561  17995.595120  14.59%  24.95%  30.23%  37.85%
Ellipsis
Validation time:  284s
Epoch 7: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:39<00:00,  2.73it/s, loss=0.311]
Total time: 1179s, loss: 0.3142
--------------------------------------------------
Epoch 7: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:39<00:00,  2.73it/s, loss=0.311]
Epoch    8,
Epoch 8:  92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                   | 2964/3216 [14:54<01:16,  3.31it/s, loss=0.307]
Training time:  894s
Epoch 8: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:22<00:00,  2.77it/s, loss=0.307]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.192800  20000.493028  12.55%  22.31%  26.00%  33.76%
head ranking  0.260249  17422.747012  19.22%  28.29%  33.86%  41.04%
mean ranking  0.226525  18711.620020  15.89%  25.30%  29.93%  37.40%
Ellipsis
Validation time:  267s
Epoch 8: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:22<00:00,  2.77it/s, loss=0.307]
Total time: 1162s, loss: 0.2985
--------------------------------------------------
Epoch 8: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:22<00:00,  2.77it/s, loss=0.307]
Epoch    9,
Epoch 9:  92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                   | 2964/3216 [14:54<01:16,  3.32it/s, loss=0.3]
Training time:  894s
Epoch 9: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:40<00:00,  2.72it/s, loss=0.3]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.190081  19821.110558  13.05%  20.92%  25.20%  31.77%
head ranking  0.284175  16333.181275  21.22%  31.37%  36.65%  44.32%
mean ranking  0.237128  18077.145916  17.13%  26.15%  30.93%  38.05%
Ellipsis
Validation time:  286s
Epoch 9: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:40<00:00,  2.72it/s, loss=0.3]
Total time: 1180s, loss: 0.2860
--------------------------------------------------
Epoch 9: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:40<00:00,  2.72it/s, loss=0.3]
Epoch   10,
Epoch 10:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [14:53<01:15,  3.32it/s, loss=0.296]
Training time:  894s
Epoch 10: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:37<00:00,  2.73it/s, loss=0.296]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.198238  19161.013944  13.25%  21.51%  27.19%  34.26%
head ranking  0.245016  16541.236056  16.83%  27.39%  33.57%  41.14%
mean ranking  0.221627  17851.125000  15.04%  24.45%  30.38%  37.70%
Ellipsis
Validation time:  283s
Epoch 10: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:37<00:00,  2.73it/s, loss=0.296]
Total time: 1177s, loss: 0.2744
--------------------------------------------------
Epoch 10: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:37<00:00,  2.73it/s, loss=0.296]
Epoch   11,
Epoch 11:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [14:52<01:15,  3.32it/s, loss=0.271]
Training time:  892s
Epoch 11: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:39<00:00,  2.73it/s, loss=0.271]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.202867  19432.394422  13.65%  22.71%  26.89%  34.66%
head ranking  0.243969  16987.731076  16.43%  27.19%  34.06%  43.03%
mean ranking  0.223418  18210.062749  15.04%  24.95%  30.48%  38.84%
Ellipsis
Validation time:  286s
Epoch 11: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:39<00:00,  2.73it/s, loss=0.271]
Total time: 1179s, loss: 0.2650
--------------------------------------------------
Epoch 11: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:39<00:00,  2.73it/s, loss=0.271]
Epoch   12,
Epoch 12:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [14:51<01:15,  3.32it/s, loss=0.263]
Training time:  892s
Epoch 12: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:36<00:00,  2.73it/s, loss=0.263]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.199065  19159.853586  12.75%  22.41%  28.09%  35.56%
head ranking  0.255957  16176.646414  17.83%  27.79%  34.26%  42.73%
mean ranking  0.227511  17668.250000  15.29%  25.10%  31.18%  39.14%
Ellipsis
Validation time:  284s
Epoch 12: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:36<00:00,  2.73it/s, loss=0.263]
Total time: 1176s, loss: 0.2569
--------------------------------------------------
Epoch 12: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:36<00:00,  2.73it/s, loss=0.263]
Epoch   13,
Epoch 13:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [14:53<01:15,  3.32it/s, loss=0.257]
Training time:  894s
Epoch 13: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:31<00:00,  2.75it/s, loss=0.257]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.208031  19552.765936  14.74%  22.81%  26.99%  34.56%
head ranking  0.288210  15540.984064  20.92%  32.67%  37.85%  44.12%
mean ranking  0.248121  17546.875000  17.83%  27.74%  32.42%  39.34%
Ellipsis
Validation time:  277s
Epoch 13: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:31<00:00,  2.75it/s, loss=0.257]
Total time: 1171s, loss: 0.2492
--------------------------------------------------
Epoch 13: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:31<00:00,  2.75it/s, loss=0.257]
Epoch   14,
Epoch 14:  92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                   | 2964/3216 [14:52<01:15,  3.32it/s, loss=0.25]
Training time:  892s
Epoch 14: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:38<00:00,  2.73it/s, loss=0.25]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.212682  18735.135458  15.44%  23.51%  26.99%  34.66%
head ranking  0.257258  16396.360558  17.43%  30.28%  35.16%  43.92%
mean ranking  0.234970  17565.748008  16.43%  26.89%  31.08%  39.29%
Ellipsis
Validation time:  286s
Epoch 14: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:38<00:00,  2.73it/s, loss=0.25]
Total time: 1178s, loss: 0.2425
--------------------------------------------------
Epoch 14: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:38<00:00,  2.73it/s, loss=0.25]
Epoch   15,
Epoch 15:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [14:53<01:15,  3.32it/s, loss=0.244]
Training time:  893s
Epoch 15: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:42<00:00,  2.72it/s, loss=0.244]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.211320  18470.387450  14.84%  22.61%  28.19%  36.45%
head ranking  0.281330  16008.371514  20.62%  31.77%  36.45%  45.02%
mean ranking  0.246325  17239.379482  17.73%  27.19%  32.32%  40.74%
Ellipsis
Validation time:  289s
Epoch 15: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:42<00:00,  2.72it/s, loss=0.244]
Total time: 1182s, loss: 0.2366
--------------------------------------------------
Epoch 15: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:42<00:00,  2.72it/s, loss=0.244]
Epoch   16,
Epoch 16:  92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                   | 2964/3216 [14:52<01:15,  3.32it/s, loss=0.25]
Training time:  892s
Epoch 16: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:32<00:00,  2.74it/s, loss=0.25]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.218792  17988.683267  15.04%  24.70%  28.78%  35.66%
head ranking  0.287593  15029.436255  21.12%  31.87%  37.95%  46.81%
mean ranking  0.253193  16509.059761  18.08%  28.29%  33.37%  41.24%
Ellipsis
Validation time:  279s
Epoch 16: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:32<00:00,  2.74it/s, loss=0.25]
Total time: 1172s, loss: 0.2323
--------------------------------------------------
Epoch 16: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:32<00:00,  2.74it/s, loss=0.25]
Epoch   17,
Epoch 17:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [14:52<01:15,  3.32it/s, loss=0.225]
Training time:  892s
Epoch 17: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:31<00:00,  2.74it/s, loss=0.225]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.204533  18534.613546  13.15%  23.51%  28.39%  36.16%
head ranking  0.275546  16466.073705  19.92%  31.27%  35.96%  45.02%
mean ranking  0.240040  17500.343625  16.53%  27.39%  32.17%  40.59%
Ellipsis
Validation time:  279s
Epoch 17: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:31<00:00,  2.74it/s, loss=0.225]
Total time: 1171s, loss: 0.2274
--------------------------------------------------
Epoch 17: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:31<00:00,  2.74it/s, loss=0.225]
Epoch   18,
Epoch 18:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [14:52<01:15,  3.32it/s, loss=0.225]
Training time:  892s
Epoch 18: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:27<00:00,  2.76it/s, loss=0.225]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.226153  18140.707171  16.33%  24.80%  27.69%  36.75%
head ranking  0.292965  16165.956175  21.31%  33.76%  38.35%  45.42%
mean ranking  0.259559  17153.331673  18.82%  29.28%  33.02%  41.09%
Ellipsis
Validation time:  274s
Epoch 18: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:27<00:00,  2.76it/s, loss=0.225]
Total time: 1167s, loss: 0.2236
--------------------------------------------------
Epoch 18: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:27<00:00,  2.76it/s, loss=0.225]
Epoch   19,
Epoch 19:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [14:54<01:16,  3.31it/s, loss=0.224]
Training time:  894s
Epoch 19: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:21<00:00,  2.77it/s, loss=0.224]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.224960  18376.506972  15.34%  26.10%  29.88%  38.84%
head ranking  0.254935  16479.586653  17.73%  28.59%  35.16%  42.33%
mean ranking  0.239948  17428.046813  16.53%  27.34%  32.52%  40.59%
Ellipsis
Validation time:  266s
Epoch 19: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:21<00:00,  2.77it/s, loss=0.224]
Total time: 1161s, loss: 0.2192
--------------------------------------------------
Epoch 19: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:21<00:00,  2.77it/s, loss=0.224]
Epoch   20,
Epoch 20:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [14:53<01:15,  3.32it/s, loss=0.219]
Training time:  893s
Epoch 20: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:08<00:00,  2.80it/s, loss=0.219]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.225051  17040.607570  15.64%  26.10%  29.28%  37.35%
head ranking  0.292639  16317.686255  22.01%  32.97%  37.55%  45.12%
mean ranking  0.258845  16679.146912  18.82%  29.53%  33.42%  41.24%
Ellipsis
Validation time:  255s
Epoch 20: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:09<00:00,  2.80it/s, loss=0.219]
Total time: 1149s, loss: 0.2167
--------------------------------------------------
Epoch 20: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:09<00:00,  2.80it/s, loss=0.219]
Epoch   21,
Epoch 21:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [14:54<01:16,  3.31it/s, loss=0.231]
Training time:  894s
Epoch 21: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:32<00:00,  2.74it/s, loss=0.231]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.218606  19009.643426  15.34%  24.00%  27.99%  35.86%
head ranking  0.265435  16868.672311  19.32%  30.18%  35.06%  42.43%
mean ranking  0.242020  17939.157869  17.33%  27.09%  31.52%  39.14%
Ellipsis
Validation time:  277s
Epoch 21: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:32<00:00,  2.74it/s, loss=0.231]
Total time: 1172s, loss: 0.2134
--------------------------------------------------
Epoch 21: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:32<00:00,  2.74it/s, loss=0.231]
Epoch   22,
Epoch 22:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [14:52<01:15,  3.32it/s, loss=0.221]
Training time:  893s
Epoch 22: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:34<00:00,  2.74it/s, loss=0.221]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.223434  18248.989044  15.94%  24.50%  28.69%  36.45%
head ranking  0.278140  15970.479084  20.42%  30.08%  37.05%  44.02%
mean ranking  0.250787  17109.734064  18.18%  27.29%  32.87%  40.24%
Ellipsis
Validation time:  281s
Epoch 22: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:34<00:00,  2.74it/s, loss=0.221]
Total time: 1174s, loss: 0.2099
--------------------------------------------------
Epoch 22: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:34<00:00,  2.74it/s, loss=0.221]
Epoch   23,
Epoch 23:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [14:54<01:16,  3.32it/s, loss=0.217]
Training time:  894s
Epoch 23: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:34<00:00,  2.74it/s, loss=0.217]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.229243  17250.897410  16.04%  25.50%  30.48%  38.05%
head ranking  0.294486  14509.879482  20.42%  34.16%  39.54%  48.01%
mean ranking  0.261864  15880.388446  18.23%  29.83%  35.01%  43.03%
Ellipsis
Validation time:  280s
Epoch 23: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:34<00:00,  2.74it/s, loss=0.217]
Total time: 1174s, loss: 0.2074
--------------------------------------------------
Epoch 23: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:34<00:00,  2.74it/s, loss=0.217]
Epoch   24,
Epoch 24:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [14:52<01:15,  3.32it/s, loss=0.219]
Training time:  892s
Epoch 24: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:31<00:00,  2.74it/s, loss=0.219]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.220116  18272.877490  15.24%  24.50%  29.68%  37.05%
head ranking  0.262035  16392.459163  18.92%  28.88%  34.66%  43.13%
mean ranking  0.241075  17332.668327  17.08%  26.69%  32.17%  40.09%
Ellipsis
Validation time:  279s
Epoch 24: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:31<00:00,  2.74it/s, loss=0.219]
Total time: 1171s, loss: 0.2058
--------------------------------------------------
Epoch 24: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:31<00:00,  2.74it/s, loss=0.219]
Epoch   25,
Epoch 25:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [14:53<01:15,  3.32it/s, loss=0.207]
Training time:  894s
Epoch 25: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:38<00:00,  2.73it/s, loss=0.207]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.229763  17451.961155  16.83%  24.70%  30.58%  37.65%
head ranking  0.265532  15973.409363  18.33%  31.18%  35.16%  43.13%
mean ranking  0.247648  16712.685259  17.58%  27.94%  32.87%  40.39%
Ellipsis
Validation time:  284s
Epoch 25: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:38<00:00,  2.73it/s, loss=0.207]
Total time: 1178s, loss: 0.2033
--------------------------------------------------
Epoch 25: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:38<00:00,  2.73it/s, loss=0.207]
Epoch   26,
Epoch 26:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [14:52<01:15,  3.32it/s, loss=0.205]
Training time:  892s
Epoch 26: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:30<00:00,  2.75it/s, loss=0.205]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.212226  17724.063745  14.14%  23.71%  27.99%  36.95%
head ranking  0.255509  16397.615538  17.03%  29.28%  35.26%  43.53%
mean ranking  0.233867  17060.839641  15.59%  26.49%  31.62%  40.24%
Ellipsis
Validation time:  277s
Epoch 26: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:30<00:00,  2.75it/s, loss=0.205]
Total time: 1170s, loss: 0.2015
--------------------------------------------------
Epoch 26: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:30<00:00,  2.75it/s, loss=0.205]
Epoch   27,
Epoch 27:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [14:52<01:15,  3.32it/s, loss=0.203]
Training time:  893s
Epoch 27: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:33<00:00,  2.74it/s, loss=0.203]
                  mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.22362  18989.622510  15.64%  25.20%  29.58%  37.45%
head ranking  0.26144  17074.461155  19.32%  27.59%  32.87%  41.83%
mean ranking  0.24253  18032.041833  17.48%  26.39%  31.23%  39.64%
Ellipsis
Validation time:  280s
Epoch 27: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:33<00:00,  2.74it/s, loss=0.203]
Total time: 1173s, loss: 0.1997
--------------------------------------------------
Epoch 27: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:33<00:00,  2.74it/s, loss=0.203]
Epoch   28,
Epoch 28:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [14:54<01:16,  3.32it/s, loss=0.203]
Training time:  894s
Epoch 28: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:33<00:00,  2.74it/s, loss=0.203]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.228709  17694.326693  16.14%  24.80%  30.58%  36.95%
head ranking  0.230960  19197.406375  16.33%  25.90%  29.88%  37.05%
mean ranking  0.229834  18445.866534  16.24%  25.35%  30.23%  37.00%
Ellipsis
Validation time:  278s
Epoch 28: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:33<00:00,  2.74it/s, loss=0.203]
Total time: 1173s, loss: 0.1984
--------------------------------------------------
Epoch 28: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:33<00:00,  2.74it/s, loss=0.203]
Epoch   29,
Epoch 29:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [14:52<01:15,  3.32it/s, loss=0.213]
Training time:  893s
Epoch 29: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:31<00:00,  2.74it/s, loss=0.213]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.226131  17677.641434  15.84%  24.60%  29.88%  38.45%
head ranking  0.239827  18179.827689  16.53%  26.99%  31.57%  41.24%
mean ranking  0.232979  17928.734562  16.19%  25.80%  30.73%  39.84%
Ellipsis
Validation time:  278s
Epoch 29: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:31<00:00,  2.74it/s, loss=0.213]
Total time: 1171s, loss: 0.1964
--------------------------------------------------
Epoch 29: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:31<00:00,  2.74it/s, loss=0.213]
`Trainer.fit` stopped: `max_epochs=30` reached.
Epoch 29: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [19:31<00:00,  2.74it/s, loss=0.213]
model_path: [./checkpoint/NELL-2023-12-07 23:18:18.540638/NELL-epoch=025-val_mrr=0.2298.ckpt]
You are using a CUDA device ('NVIDIA A100-PCIE-40GB') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3,4,5,6,7]
Testing DataLoader 1: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 270/270 [04:44<00:00,  1.05s/it]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.299493  15060.369323  22.57%  33.32%  38.32%  45.04%
head ranking  0.309479  13249.819277  22.34%  34.52%  41.06%  48.75%
mean ranking  0.304486  14155.094300  22.45%  33.92%  39.69%  46.90%

==================================================
Epoch: test
Ellipsis
==================================================
Testing DataLoader 1: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 270/270 [04:44<00:00,  1.05s/it]
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
       Test metric             DataLoader 0             DataLoader 1
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
         val_mrr            0.29949331283569336      0.29949331283569336
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
(KG-S2S) dlt@dl012:~/proj/KG-S2S$

