(KG-S2S) chrisjihee@dgx-a100:~/proj/KG-S2S$ bash setting-paper/train-NELL.sh
Namespace(dataset_path='./data/processed', dataset='NELL', model='T5Finetuner', gpu='3', seed=41504, num_workers=4, save_dir='./checkpoint/NELL-2023-12-07 23:14:34.933323', pretrained_model='t5-base', batch_size=128, val_batch_size=8, num_beams=40, num_beam_groups=1, src_max_length=512, train_tgt_max_length=512, eval_tgt_max_length=25, epochs=30, lr=0.0005, diversity_penalty=0.0, model_path='', optim='Adam', decoder='beam_search', log_text=False, use_prefix_search=False, src_descrip_max_length=0, tgt_descrip_max_length=0, use_soft_prompt=True, use_rel_prompt_emb=True, skip_n_val_epoch=0, seq_dropout=0.0, temporal=False, n_ent=68544, n_rel=358, vocab_size=32128, model_dim=768)
Global seed set to 41504
tokenizing entities...
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 68544/68544 [00:29<00:00, 2350.13it/s]
datamodule construction done.

----------------------------------------------------------------------------------
 * pl.Trainer(accelerator=gpu, devices=[3])
----------------------------------------------------------------------------------

GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
model construction done.
You are using a CUDA device ('A100-SXM4-40GB') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3,4,5,6,7]

  | Name                       | Type                               | Params
----------------------------------------------------------------------------------
0 | T5ForConditionalGeneration | ModifiedT5ForConditionalGeneration | 222 M
1 | rel_embed1                 | Embedding                          | 274 K
2 | rel_embed2                 | Embedding                          | 274 K
3 | rel_embed3                 | Embedding                          | 274 K
4 | rel_embed4                 | Embedding                          | 274 K
----------------------------------------------------------------------------------
224 M     Trainable params
0         Non-trainable params
224 M     Total params
896.013   Total estimated model params size (MB)
Training: 0it [00:00, ?it/s]
Epoch:    0,
Epoch 0:  92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊             | 2964/3216 [13:40<01:09,  3.61it/s, loss=0.581]
Training time:  820s
Epoch 0: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:22<00:00,  2.92it/s, loss=0.581]
                   mrr            mr  hit@1   hit@3   hit@5  hit@10
tail ranking  0.130774  22559.265936  7.47%  14.34%  19.32%  25.80%
head ranking  0.155020  21912.140438  9.06%  18.63%  24.00%  29.58%
mean ranking  0.142897  22235.703187  8.27%  16.48%  21.66%  27.69%
Ellipsis
Validation time:  282s
Epoch 0: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:22<00:00,  2.92it/s, loss=0.581]
Total time: 1102s, loss: 0.6414
--------------------------------------------------
Epoch 0: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:22<00:00,  2.92it/s, loss=0.581]
Epoch:    1,
Epoch 1:  92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊             | 2964/3216 [13:39<01:09,  3.62it/s, loss=0.493]
Training time:  819s
Epoch 1: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:08<00:00,  2.96it/s, loss=0.493]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.135107  20179.590637   7.67%  13.84%  19.52%  28.78%
head ranking  0.220863  17125.750000  14.24%  24.80%  29.28%  40.54%
mean ranking  0.177985  18652.670319  10.96%  19.32%  24.40%  34.66%
Ellipsis
Validation time:  268s
Epoch 1: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:08<00:00,  2.96it/s, loss=0.493]
Total time: 1088s, loss: 0.5139
--------------------------------------------------
Epoch 1: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:08<00:00,  2.96it/s, loss=0.493]
Epoch:    2,
Epoch 2:  92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊             | 2964/3216 [13:37<01:09,  3.63it/s, loss=0.463]
Training time:  817s
Epoch 2: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:21<00:00,  2.92it/s, loss=0.463]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.150393  20232.079681   9.26%  15.34%  22.01%  29.88%
head ranking  0.219878  16457.477092  13.15%  25.70%  33.07%  42.33%
mean ranking  0.185135  18344.778386  11.21%  20.52%  27.54%  36.11%
Ellipsis
Validation time:  283s
Epoch 2: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:21<00:00,  2.92it/s, loss=0.463]
Total time: 1101s, loss: 0.4542
--------------------------------------------------
Epoch 2: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:21<00:00,  2.92it/s, loss=0.463]
Epoch:    3,
Epoch 3:  92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊             | 2964/3216 [13:39<01:09,  3.62it/s, loss=0.426]
Training time:  819s
Epoch 3: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:26<00:00,  2.91it/s, loss=0.426]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.169111  19408.681275  10.36%  19.02%  24.40%  32.17%
head ranking  0.219691  15871.438247  13.05%  23.90%  33.27%  43.23%
mean ranking  0.194401  17640.059761  11.70%  21.46%  28.83%  37.70%
Ellipsis
Validation time:  286s
Epoch 3: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:26<00:00,  2.91it/s, loss=0.426]
Total time: 1106s, loss: 0.4134
--------------------------------------------------
Epoch 3: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:26<00:00,  2.91it/s, loss=0.426]
Epoch:    4,
Epoch 4:  92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊             | 2964/3216 [13:37<01:09,  3.63it/s, loss=0.382]
Training time:  817s
Epoch 4: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:29<00:00,  2.90it/s, loss=0.382]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.157502  19939.319721   9.56%  17.03%  22.91%  28.88%
head ranking  0.214412  16753.345618  14.14%  23.01%  29.18%  39.74%
mean ranking  0.185957  18346.332669  11.85%  20.02%  26.05%  34.31%
Ellipsis
Validation time:  292s
Epoch 4: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:29<00:00,  2.90it/s, loss=0.382]
Total time: 1109s, loss: 0.3813
--------------------------------------------------
Epoch 4: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:29<00:00,  2.90it/s, loss=0.382]
Epoch:    5,
Epoch 5:  92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊             | 2964/3216 [13:38<01:09,  3.62it/s, loss=0.357]
Training time:  818s
Epoch 5: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:29<00:00,  2.90it/s, loss=0.357]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.171115  20834.126494  10.96%  19.22%  23.61%  31.18%
head ranking  0.239709  16600.958167  16.43%  26.99%  32.37%  40.34%
mean ranking  0.205412  18717.542331  13.70%  23.11%  27.99%  35.76%
Ellipsis
Validation time:  290s
Epoch 5: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:29<00:00,  2.90it/s, loss=0.357]
Total time: 1109s, loss: 0.3544
--------------------------------------------------
Epoch 5: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:29<00:00,  2.90it/s, loss=0.357]
Epoch:    6,
Epoch 6:  92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊             | 2964/3216 [13:38<01:09,  3.62it/s, loss=0.325]
Training time:  818s
Epoch 6: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:23<00:00,  2.92it/s, loss=0.325]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.181988  19323.747012  11.16%  19.82%  26.10%  34.56%
head ranking  0.210035  17354.609562  14.34%  22.61%  28.39%  36.55%
mean ranking  0.196011  18339.178287  12.75%  21.22%  27.24%  35.56%
Ellipsis
Validation time:  284s
Epoch 6: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:23<00:00,  2.92it/s, loss=0.325]
Total time: 1103s, loss: 0.3332
--------------------------------------------------
Epoch 6: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:23<00:00,  2.92it/s, loss=0.325]
Epoch:    7,
Epoch 7:  92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                   | 2964/3216 [13:37<01:09,  3.63it/s, loss=0.312]
Training time:  817s
Epoch 7: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:35<00:00,  2.88it/s, loss=0.312]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.185919  19116.082669  12.25%  20.52%  25.50%  33.17%
head ranking  0.207944  19185.587649  14.34%  23.21%  28.19%  35.96%
mean ranking  0.196932  19150.835159  13.30%  21.86%  26.84%  34.56%
Ellipsis
Validation time:  298s
Epoch 7: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:35<00:00,  2.88it/s, loss=0.312]
Total time: 1115s, loss: 0.3143
--------------------------------------------------
Epoch 7: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:35<00:00,  2.88it/s, loss=0.312]
Epoch:    8,
Epoch 8:  92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                   | 2964/3216 [13:38<01:09,  3.62it/s, loss=0.303]
Training time:  818s
Epoch 8: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:23<00:00,  2.91it/s, loss=0.303]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.191329  20220.768924  12.05%  22.41%  27.09%  32.97%
head ranking  0.222731  18638.300797  15.64%  24.60%  29.08%  37.55%
mean ranking  0.207030  19429.534861  13.84%  23.51%  28.09%  35.26%
Ellipsis
Validation time:  285s
Epoch 8: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:23<00:00,  2.91it/s, loss=0.303]
Total time: 1103s, loss: 0.2990
--------------------------------------------------
Epoch 8: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:23<00:00,  2.91it/s, loss=0.303]
Epoch:    9,
Epoch 9:  92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                   | 2964/3216 [13:36<01:09,  3.63it/s, loss=0.304]
Training time:  816s
Epoch 9: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:14<00:00,  2.94it/s, loss=0.304]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.189673  20224.669323  12.85%  20.82%  25.80%  31.97%
head ranking  0.237349  17086.668327  16.43%  26.39%  32.47%  40.94%
mean ranking  0.213511  18655.668825  14.64%  23.61%  29.13%  36.45%
Ellipsis
Validation time:  278s
Epoch 9: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:14<00:00,  2.94it/s, loss=0.304]
Total time: 1094s, loss: 0.2863
--------------------------------------------------
Epoch 9: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:14<00:00,  2.94it/s, loss=0.304]
Epoch:   10,
Epoch 10:  92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                   | 2964/3216 [13:37<01:09,  3.63it/s, loss=0.29]
Training time:  817s
Epoch 10: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:17<00:00,  2.93it/s, loss=0.29]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.201587  19755.684263  13.65%  22.71%  27.49%  32.77%
head ranking  0.229747  16940.956175  14.94%  26.20%  31.57%  42.33%
mean ranking  0.215667  18348.320219  14.29%  24.45%  29.53%  37.55%
Ellipsis
Validation time:  279s
Epoch 10: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:17<00:00,  2.93it/s, loss=0.29]
Total time: 1097s, loss: 0.2749
--------------------------------------------------
Epoch 10: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:17<00:00,  2.93it/s, loss=0.29]
Epoch:   11,
Epoch 11:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [13:37<01:09,  3.63it/s, loss=0.271]
Training time:  817s
Epoch 11: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:18<00:00,  2.93it/s, loss=0.271]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.197734  20488.406375  13.35%  22.61%  26.99%  33.76%
head ranking  0.224668  19015.958167  15.34%  24.50%  31.27%  39.24%
mean ranking  0.211201  19752.182271  14.34%  23.56%  29.13%  36.50%
Ellipsis
Validation time:  281s
Epoch 11: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:18<00:00,  2.93it/s, loss=0.271]
Total time: 1098s, loss: 0.2655
--------------------------------------------------
Epoch 11: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:18<00:00,  2.93it/s, loss=0.271]
Epoch:   12,
Epoch 12:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [13:39<01:09,  3.62it/s, loss=0.262]
Training time:  819s
Epoch 12: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:22<00:00,  2.92it/s, loss=0.262]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.211462  18592.175299  14.74%  23.11%  28.09%  35.66%
head ranking  0.235090  19253.560757  17.23%  25.80%  30.28%  37.85%
mean ranking  0.223276  18922.868028  15.99%  24.45%  29.18%  36.75%
Ellipsis
Validation time:  283s
Epoch 12: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:22<00:00,  2.92it/s, loss=0.262]
Total time: 1102s, loss: 0.2574
--------------------------------------------------
Epoch 12: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:22<00:00,  2.92it/s, loss=0.262]
Epoch:   13,
Epoch 13:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [13:37<01:09,  3.62it/s, loss=0.254]
Training time:  817s
Epoch 13: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:17<00:00,  2.93it/s, loss=0.254]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.196114  18794.973108  13.25%  22.21%  26.00%  34.16%
head ranking  0.233225  18118.377490  16.83%  25.30%  30.48%  38.05%
mean ranking  0.214670  18456.675299  15.04%  23.75%  28.24%  36.11%
Ellipsis
Validation time:  279s
Epoch 13: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:17<00:00,  2.93it/s, loss=0.254]
Total time: 1097s, loss: 0.2498
--------------------------------------------------
Epoch 13: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:17<00:00,  2.93it/s, loss=0.254]
Epoch:   14,
Epoch 14:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [13:39<01:09,  3.62it/s, loss=0.248]
Training time:  819s
Epoch 14: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:18<00:00,  2.93it/s, loss=0.248]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.210725  19261.626494  14.94%  23.41%  27.59%  34.76%
head ranking  0.222606  19274.082669  16.14%  24.40%  28.19%  34.56%
mean ranking  0.216665  19267.854582  15.54%  23.90%  27.89%  34.66%
Ellipsis
Validation time:  279s
Epoch 14: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:18<00:00,  2.93it/s, loss=0.248]
Total time: 1098s, loss: 0.2430
--------------------------------------------------
Epoch 14: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:18<00:00,  2.93it/s, loss=0.248]
Epoch:   15,
Epoch 15:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [13:38<01:09,  3.62it/s, loss=0.243]
Training time:  818s
Epoch 15: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:15<00:00,  2.94it/s, loss=0.243]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.213037  18182.757968  15.14%  23.21%  27.59%  35.16%
head ranking  0.232338  18625.979084  17.63%  25.00%  29.38%  35.76%
mean ranking  0.222688  18404.368526  16.38%  24.10%  28.49%  35.46%
Ellipsis
Validation time:  276s
Epoch 15: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:15<00:00,  2.94it/s, loss=0.243]
Total time: 1095s, loss: 0.2372
--------------------------------------------------
Epoch 15: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:15<00:00,  2.94it/s, loss=0.243]
Epoch:   16,
Epoch 16:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [13:37<01:09,  3.63it/s, loss=0.253]
Training time:  817s
Epoch 16: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:20<00:00,  2.92it/s, loss=0.253]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.210041  18284.233068  14.64%  23.31%  27.79%  34.86%
head ranking  0.234035  18681.913347  17.53%  24.40%  29.48%  39.54%
mean ranking  0.222038  18483.073207  16.09%  23.85%  28.64%  37.20%
Ellipsis
Validation time:  282s
Epoch 16: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:20<00:00,  2.92it/s, loss=0.253]
Total time: 1100s, loss: 0.2329
--------------------------------------------------
Epoch 16: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:20<00:00,  2.92it/s, loss=0.253]
Epoch:   17,
Epoch 17:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [13:39<01:09,  3.62it/s, loss=0.227]
Training time:  820s
Epoch 17: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:17<00:00,  2.93it/s, loss=0.227]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.214659  19060.863546  14.54%  24.60%  28.59%  36.25%
head ranking  0.260524  17220.976096  20.12%  26.99%  31.77%  41.04%
mean ranking  0.237591  18140.919821  17.33%  25.80%  30.18%  38.65%
Ellipsis
Validation time:  277s
Epoch 17: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:17<00:00,  2.93it/s, loss=0.227]
Total time: 1097s, loss: 0.2276
--------------------------------------------------
Epoch 17: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:17<00:00,  2.93it/s, loss=0.227]
Epoch:   18,
Epoch 18:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [13:37<01:09,  3.63it/s, loss=0.226]
Training time:  817s
Epoch 18: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:14<00:00,  2.94it/s, loss=0.226]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.207246  18985.783865  13.35%  24.20%  28.09%  35.96%
head ranking  0.246913  16594.659363  17.13%  27.49%  32.87%  43.23%
mean ranking  0.227079  17790.221614  15.24%  25.85%  30.48%  39.59%
Ellipsis
Validation time:  276s
Epoch 18: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:14<00:00,  2.94it/s, loss=0.226]
Total time: 1094s, loss: 0.2239
--------------------------------------------------
Epoch 18: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:14<00:00,  2.94it/s, loss=0.226]
Epoch:   19,
Epoch 19:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [13:38<01:09,  3.62it/s, loss=0.226]
Training time:  819s
Epoch 19: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:23<00:00,  2.91it/s, loss=0.226]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.211243  17746.936255  14.14%  23.41%  28.59%  36.55%
head ranking  0.243379  17004.199203  17.53%  26.29%  31.77%  40.94%
mean ranking  0.227311  17375.567729  15.84%  24.85%  30.18%  38.75%
Ellipsis
Validation time:  284s
Epoch 19: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:23<00:00,  2.91it/s, loss=0.226]
Total time: 1103s, loss: 0.2196
--------------------------------------------------
Epoch 19: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:23<00:00,  2.91it/s, loss=0.226]
Epoch:   20,
Epoch 20:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [13:37<01:09,  3.62it/s, loss=0.219]
Training time:  818s
Epoch 20: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:24<00:00,  2.91it/s, loss=0.219]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.220243  18273.477092  15.14%  24.60%  29.18%  36.16%
head ranking  0.268479  17068.193227  19.42%  29.78%  35.86%  42.83%
mean ranking  0.244361  17670.835159  17.28%  27.19%  32.52%  39.49%
Ellipsis
Validation time:  286s
Epoch 20: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:24<00:00,  2.91it/s, loss=0.219]
Total time: 1104s, loss: 0.2169
--------------------------------------------------
Epoch 20: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:24<00:00,  2.91it/s, loss=0.219]
Epoch:   21,
Epoch 21:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [13:40<01:09,  3.61it/s, loss=0.232]
Training time:  820s
Epoch 21: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:25<00:00,  2.91it/s, loss=0.232]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.201047  19141.605578  14.54%  20.42%  26.39%  34.86%
head ranking  0.243511  16761.571713  17.23%  26.00%  32.27%  41.73%
mean ranking  0.222279  17951.588645  15.89%  23.21%  29.33%  38.30%
Ellipsis
Validation time:  284s
Epoch 21: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:25<00:00,  2.91it/s, loss=0.232]
Total time: 1105s, loss: 0.2136
--------------------------------------------------
Epoch 21: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:25<00:00,  2.91it/s, loss=0.232]
Epoch:   22,
Epoch 22:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [13:37<01:09,  3.62it/s, loss=0.222]
Training time:  817s
Epoch 22: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:20<00:00,  2.92it/s, loss=0.222]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.209915  18006.756972  14.84%  22.61%  26.20%  34.46%
head ranking  0.256876  16246.340637  18.73%  27.99%  34.06%  41.63%
mean ranking  0.233396  17126.548805  16.78%  25.30%  30.13%  38.05%
Ellipsis
Validation time:  282s
Epoch 22: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:20<00:00,  2.92it/s, loss=0.222]
Total time: 1100s, loss: 0.2104
--------------------------------------------------
Epoch 22: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:20<00:00,  2.92it/s, loss=0.222]
Epoch:   23,
Epoch 23:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [13:37<01:09,  3.63it/s, loss=0.212]
Training time:  817s
Epoch 23: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:13<00:00,  2.94it/s, loss=0.212]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.208714  18747.812749  14.64%  22.31%  28.39%  35.66%
head ranking  0.239834  18009.968127  17.63%  26.10%  31.47%  38.05%
mean ranking  0.224274  18378.890438  16.14%  24.20%  29.93%  36.85%
Ellipsis
Validation time:  275s
Epoch 23: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:13<00:00,  2.94it/s, loss=0.212]
Total time: 1093s, loss: 0.2078
--------------------------------------------------
Epoch 23: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:13<00:00,  2.94it/s, loss=0.212]
Epoch:   24,
Epoch 24:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [13:36<01:09,  3.63it/s, loss=0.217]
Training time:  816s
Epoch 24: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:13<00:00,  2.94it/s, loss=0.217]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.210087  17382.230080  14.64%  23.01%  27.59%  35.26%
head ranking  0.245021  18816.531873  18.43%  26.69%  31.08%  38.15%
mean ranking  0.227554  18099.380976  16.53%  24.85%  29.33%  36.70%
Ellipsis
Validation time:  276s
Epoch 24: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:13<00:00,  2.94it/s, loss=0.217]
Total time: 1093s, loss: 0.2059
--------------------------------------------------
Epoch 24: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:13<00:00,  2.94it/s, loss=0.217]
Epoch:   25,
Epoch 25:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [13:38<01:09,  3.62it/s, loss=0.208]
Training time:  818s
Epoch 25: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:23<00:00,  2.91it/s, loss=0.208]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.221232  17736.716135  15.64%  24.60%  29.18%  36.55%
head ranking  0.246685  17726.127490  17.63%  26.99%  32.07%  41.14%
mean ranking  0.233959  17731.421813  16.63%  25.80%  30.63%  38.84%
Ellipsis
Validation time:  285s
Epoch 25: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:23<00:00,  2.91it/s, loss=0.208]
Total time: 1103s, loss: 0.2037
--------------------------------------------------
Epoch 25: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:23<00:00,  2.91it/s, loss=0.208]
Epoch:   26,
Epoch 26:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [13:36<01:09,  3.63it/s, loss=0.206]
Training time:  816s
Epoch 26: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:18<00:00,  2.93it/s, loss=0.206]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.195561  19765.193227  12.95%  21.41%  26.59%  34.76%
head ranking  0.239538  18457.281873  17.53%  26.49%  30.98%  38.94%
mean ranking  0.217550  19111.237550  15.24%  23.95%  28.78%  36.85%
Ellipsis
Validation time:  281s
Epoch 26: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:18<00:00,  2.93it/s, loss=0.206]
Total time: 1098s, loss: 0.2017
--------------------------------------------------
Epoch 26: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:18<00:00,  2.93it/s, loss=0.206]
Epoch:   27,
Epoch 27:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [13:37<01:09,  3.62it/s, loss=0.209]
Training time:  817s
Epoch 27: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:23<00:00,  2.91it/s, loss=0.209]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.209381  18766.795817  14.14%  24.00%  27.69%  34.86%
head ranking  0.245728  17365.226096  17.43%  27.29%  32.27%  40.34%
mean ranking  0.227554  18066.010956  15.79%  25.65%  29.98%  37.60%
Ellipsis
Validation time:  285s
Epoch 27: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:23<00:00,  2.91it/s, loss=0.209]
Total time: 1103s, loss: 0.1998
--------------------------------------------------
Epoch 27: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:23<00:00,  2.91it/s, loss=0.209]
Epoch:   28,
Epoch 28:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [13:39<01:09,  3.62it/s, loss=0.203]
Training time:  819s
Epoch 28: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:21<00:00,  2.92it/s, loss=0.203]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.209967  19255.235060  14.14%  24.50%  28.49%  35.06%
head ranking  0.242643  18749.336653  17.03%  26.79%  32.37%  39.94%
mean ranking  0.226305  19002.285857  15.59%  25.65%  30.43%  37.50%
Ellipsis
Validation time:  281s
Epoch 28: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:21<00:00,  2.92it/s, loss=0.203]
Total time: 1101s, loss: 0.1981
--------------------------------------------------
Epoch 28: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:21<00:00,  2.92it/s, loss=0.203]
Epoch:   29,
Epoch 29:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [13:37<01:09,  3.63it/s, loss=0.212]
Training time:  817s
Epoch 29: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:17<00:00,  2.93it/s, loss=0.212]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.206781  19025.355578  14.04%  23.31%  28.29%  35.46%
head ranking  0.241300  18304.736056  18.73%  26.00%  29.58%  37.25%
mean ranking  0.224041  18665.045817  16.38%  24.65%  28.93%  36.35%
Ellipsis
Validation time:  279s
Epoch 29: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:17<00:00,  2.93it/s, loss=0.212]
Total time: 1097s, loss: 0.1965
--------------------------------------------------
Epoch 29: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:17<00:00,  2.93it/s, loss=0.212]
`Trainer.fit` stopped: `max_epochs=30` reached.
Epoch 29: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:17<00:00,  2.93it/s, loss=0.212]
model_path: [./checkpoint/NELL-2023-12-07 23:14:34.933323/NELL-epoch=025-val_mrr=0.2212.ckpt]
You are using a CUDA device ('A100-SXM4-40GB') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3,4,5,6,7]
Testing DataLoader 1: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 270/270 [04:36<00:00,  1.03s/it]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.302248  15095.635774  22.52%  33.83%  38.88%  45.78%
head ranking  0.307868  12151.655236  21.87%  33.46%  41.24%  49.77%
mean ranking  0.305058  13623.645505  22.20%  33.64%  40.06%  47.78%

==================================================
Epoch: test
Ellipsis
==================================================
Testing DataLoader 1: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 270/270 [04:36<00:00,  1.03s/it]
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
       Test metric             DataLoader 0             DataLoader 1
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
         val_mrr            0.3022482395172119       0.3022482395172119
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
(KG-S2S) chrisjihee@dgx-a100:~/proj/KG-S2S$

