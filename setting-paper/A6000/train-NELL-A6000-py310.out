(KG-S2S) chrisjihee@ptlm3:~/proj/KG-S2S$ bash setting-paper/train-NELL.sh
Namespace(dataset_path='./data/processed', dataset='NELL', model='T5Finetuner', gpu='3', seed=41504, num_workers=4, save_dir='./checkpoint/NELL-2023-12-07 23:13:52.632393', pretrained_model='t5-base', batch_size=128, val_batch_size=8, num_beams=40, num_beam_groups=1, src_max_length=512, train_tgt_max_length=512, eval_tgt_max_length=25, epochs=30, lr=0.0005, diversity_penalty=0.0, model_path='', optim='Adam', decoder='beam_search', log_text=False, use_prefix_search=False, src_descrip_max_length=0, tgt_descrip_max_length=0, use_soft_prompt=True, use_rel_prompt_emb=True, skip_n_val_epoch=0, seq_dropout=0.0, temporal=False, n_ent=68544, n_rel=358, vocab_size=32128, model_dim=768)
Global seed set to 41504
tokenizing entities...
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 68544/68544 [00:28<00:00, 2383.87it/s]
datamodule construction done.

----------------------------------------------------------------------------------
 * pl.Trainer(accelerator=gpu, devices=[3])
----------------------------------------------------------------------------------

GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
model construction done.
You are using a CUDA device ('NVIDIA RTX A6000') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]

  | Name                       | Type                               | Params
----------------------------------------------------------------------------------
0 | T5ForConditionalGeneration | ModifiedT5ForConditionalGeneration | 222 M
1 | rel_embed1                 | Embedding                          | 274 K
2 | rel_embed2                 | Embedding                          | 274 K
3 | rel_embed3                 | Embedding                          | 274 K
4 | rel_embed4                 | Embedding                          | 274 K
----------------------------------------------------------------------------------
224 M     Trainable params
0         Non-trainable params
224 M     Total params
896.013   Total estimated model params size (MB)
Training: 0it [00:00, ?it/s]
Epoch:    0,
Epoch 0:  92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊             | 2964/3216 [14:09<01:12,  3.49it/s, loss=0.584]
Training time:  849s
Epoch 0: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:16<00:00,  2.93it/s, loss=0.584]
                   mrr            mr  hit@1   hit@3   hit@5  hit@10
tail ranking  0.123032  22607.590637  7.17%  11.95%  18.13%  26.49%
head ranking  0.172123  20443.540837  9.36%  21.31%  26.49%  33.47%
mean ranking  0.147577  21525.565737  8.27%  16.63%  22.31%  29.98%
Ellipsis
Validation time:  247s
Epoch 0: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:16<00:00,  2.93it/s, loss=0.584]
Total time: 1096s, loss: 0.6405
--------------------------------------------------
Epoch 0: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:16<00:00,  2.93it/s, loss=0.584]
Epoch:    1,
Epoch 1:  92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊             | 2964/3216 [14:09<01:12,  3.49it/s, loss=0.497]
Training time:  849s
Epoch 1: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:07<00:00,  2.96it/s, loss=0.497]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.125524  20055.719124   6.18%  14.04%  19.32%  27.69%
head ranking  0.212123  18248.100598  12.45%  25.80%  31.37%  38.55%
mean ranking  0.168824  19151.909861   9.31%  19.92%  25.35%  33.12%
Ellipsis
Validation time:  237s
Epoch 1: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:07<00:00,  2.96it/s, loss=0.497]
Total time: 1087s, loss: 0.5164
--------------------------------------------------
Epoch 1: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:07<00:00,  2.96it/s, loss=0.497]
Epoch:    2,
Epoch 2:  92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊             | 2964/3216 [14:08<01:12,  3.49it/s, loss=0.469]
Training time:  848s
Epoch 2: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:19<00:00,  2.92it/s, loss=0.469]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.150721  20615.309761   9.56%  16.04%  21.51%  27.99%
head ranking  0.217094  16784.523904  13.15%  25.70%  30.98%  39.84%
mean ranking  0.183907  18699.916833  11.35%  20.87%  26.25%  33.91%
Ellipsis
Validation time:  251s
Epoch 2: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:19<00:00,  2.92it/s, loss=0.469]
Total time: 1099s, loss: 0.4563
--------------------------------------------------
Epoch 2: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:19<00:00,  2.92it/s, loss=0.469]
Epoch:    3,
Epoch 3:  92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊             | 2964/3216 [14:08<01:12,  3.49it/s, loss=0.426]
Training time:  848s
Epoch 3: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:16<00:00,  2.93it/s, loss=0.426]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.177794  20238.956175  11.95%  19.62%  24.60%  30.08%
head ranking  0.182653  19298.407371  12.25%  19.62%  24.50%  32.77%
mean ranking  0.180223  19768.681773  12.10%  19.62%  24.55%  31.42%
Ellipsis
Validation time:  247s
Epoch 3: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:16<00:00,  2.93it/s, loss=0.426]
Total time: 1096s, loss: 0.4160
--------------------------------------------------
Epoch 3: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:16<00:00,  2.93it/s, loss=0.426]
Epoch:    4,
Epoch 4:  92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊             | 2964/3216 [14:07<01:12,  3.50it/s, loss=0.387]
Training time:  847s
Epoch 4: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:22<00:00,  2.92it/s, loss=0.387]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.166886  20565.703187  10.26%  18.73%  23.61%  30.78%
head ranking  0.200153  17912.009960  12.85%  22.21%  27.59%  37.15%
mean ranking  0.183520  19238.856574  11.55%  20.47%  25.60%  33.96%
Ellipsis
Validation time:  254s
Epoch 4: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:22<00:00,  2.92it/s, loss=0.387]
Total time: 1102s, loss: 0.3837
--------------------------------------------------
Epoch 4: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:22<00:00,  2.92it/s, loss=0.387]
Epoch:    5,
Epoch 5:  92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊             | 2964/3216 [14:08<01:12,  3.49it/s, loss=0.357]
Training time:  849s
Epoch 5: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:30<00:00,  2.90it/s, loss=0.357]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.169298  21076.277888  11.16%  19.22%  22.61%  29.18%
head ranking  0.231507  17095.093625  15.24%  27.29%  32.77%  40.34%
mean ranking  0.200403  19085.685757  13.20%  23.26%  27.69%  34.76%
Ellipsis
Validation time:  261s
Epoch 5: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:30<00:00,  2.90it/s, loss=0.357]
Total time: 1110s, loss: 0.3573
--------------------------------------------------
Epoch 5: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:30<00:00,  2.90it/s, loss=0.357]
Epoch:    6,
Epoch 6:  92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊             | 2964/3216 [14:07<01:12,  3.50it/s, loss=0.331]
Training time:  848s
Epoch 6: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:14<00:00,  2.94it/s, loss=0.331]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.192089  19041.019920  13.05%  20.92%  25.80%  32.97%
head ranking  0.228717  16493.310757  15.74%  25.40%  30.88%  39.64%
mean ranking  0.210403  17767.165339  14.39%  23.16%  28.34%  36.30%
Ellipsis
Validation time:  246s
Epoch 6: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:14<00:00,  2.94it/s, loss=0.331]
Total time: 1094s, loss: 0.3353
--------------------------------------------------
Epoch 6: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:14<00:00,  2.94it/s, loss=0.331]
Epoch:    7,
Epoch 7:  92%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                   | 2964/3216 [14:09<01:12,  3.49it/s, loss=0.312]
Training time:  849s
Epoch 7: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:20<00:00,  2.92it/s, loss=0.312]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.189348  18845.381474  12.75%  20.52%  25.10%  33.76%
head ranking  0.230566  17200.291833  15.74%  25.00%  29.88%  41.14%
mean ranking  0.209957  18022.836653  14.24%  22.76%  27.49%  37.45%
Ellipsis
Validation time:  251s
Epoch 7: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:20<00:00,  2.92it/s, loss=0.312]
Total time: 1100s, loss: 0.3166
--------------------------------------------------
Epoch 7: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:20<00:00,  2.92it/s, loss=0.312]
Epoch:    8,
Epoch 8:  92%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                   | 2964/3216 [14:10<01:12,  3.49it/s, loss=0.301]
Training time:  850s
Epoch 8: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:16<00:00,  2.93it/s, loss=0.301]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.194328  20745.636454  13.45%  21.22%  25.40%  32.87%
head ranking  0.234292  17660.893426  16.53%  25.90%  30.58%  39.14%
mean ranking  0.214310  19203.264940  14.99%  23.56%  27.99%  36.01%
Ellipsis
Validation time:  246s
Epoch 8: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:16<00:00,  2.93it/s, loss=0.301]
Total time: 1096s, loss: 0.3006
--------------------------------------------------
Epoch 8: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:16<00:00,  2.93it/s, loss=0.301]
Epoch:    9,
Epoch 9:  92%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                   | 2964/3216 [14:08<01:12,  3.49it/s, loss=0.308]
Training time:  849s
Epoch 9: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:13<00:00,  2.94it/s, loss=0.308]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.187326  20175.578685  12.85%  20.52%  25.50%  32.37%
head ranking  0.240292  17345.359562  17.73%  25.50%  30.28%  38.84%
mean ranking  0.213809  18760.469124  15.29%  23.01%  27.89%  35.61%
Ellipsis
Validation time:  244s
Epoch 9: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:13<00:00,  2.94it/s, loss=0.308]
Total time: 1093s, loss: 0.2878
--------------------------------------------------
Epoch 9: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:13<00:00,  2.94it/s, loss=0.308]
Epoch:   10,
Epoch 10:  92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                   | 2964/3216 [14:08<01:12,  3.49it/s, loss=0.3]
Training time:  848s
Epoch 10: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:11<00:00,  2.95it/s, loss=0.3]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.193528  19840.865538  13.25%  21.51%  26.59%  33.37%
head ranking  0.249877  15725.308765  17.13%  26.69%  34.26%  42.93%
mean ranking  0.221702  17783.087151  15.19%  24.10%  30.43%  38.15%
Ellipsis
Validation time:  243s
Epoch 10: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:11<00:00,  2.95it/s, loss=0.3]
Total time: 1091s, loss: 0.2762
--------------------------------------------------
Epoch 10: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:11<00:00,  2.95it/s, loss=0.3]
Epoch:   11,
Epoch 11:  92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [14:07<01:12,  3.50it/s, loss=0.276]
Training time:  847s
Epoch 11: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:15<00:00,  2.93it/s, loss=0.276]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.203055  20128.108566  14.34%  22.41%  26.69%  32.37%
head ranking  0.221349  18400.909363  15.14%  24.50%  29.28%  37.85%
mean ranking  0.212202  19264.508964  14.74%  23.46%  27.99%  35.11%
Ellipsis
Validation time:  248s
Epoch 11: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:15<00:00,  2.93it/s, loss=0.276]
Total time: 1095s, loss: 0.2669
--------------------------------------------------
Epoch 11: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:15<00:00,  2.93it/s, loss=0.276]
Epoch:   12,
Epoch 12:  92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [14:08<01:12,  3.49it/s, loss=0.262]
Training time:  848s
Epoch 12: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:10<00:00,  2.95it/s, loss=0.262]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.202009  18947.157371  13.84%  22.61%  26.00%  34.26%
head ranking  0.239407  18088.658367  17.63%  26.00%  30.18%  38.25%
mean ranking  0.220708  18517.907869  15.74%  24.30%  28.09%  36.25%
Ellipsis
Validation time:  241s
Epoch 12: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:10<00:00,  2.95it/s, loss=0.262]
Total time: 1090s, loss: 0.2583
--------------------------------------------------
Epoch 12: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:10<00:00,  2.95it/s, loss=0.262]
Epoch:   13,
Epoch 13:  92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [14:08<01:12,  3.49it/s, loss=0.262]
Training time:  848s
Epoch 13: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:14<00:00,  2.94it/s, loss=0.262]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.198875  18515.135458  13.05%  22.31%  28.09%  34.26%
head ranking  0.240431  17459.321713  17.93%  25.80%  29.68%  39.04%
mean ranking  0.219653  17987.228586  15.49%  24.05%  28.88%  36.65%
Ellipsis
Validation time:  245s
Epoch 13: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:14<00:00,  2.94it/s, loss=0.262]
Total time: 1094s, loss: 0.2508
--------------------------------------------------
Epoch 13: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:14<00:00,  2.94it/s, loss=0.262]
Epoch:   14,
Epoch 14:  92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [14:09<01:12,  3.49it/s, loss=0.255]
Training time:  849s
Epoch 14: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:20<00:00,  2.92it/s, loss=0.255]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.215102  19248.650398  15.04%  23.41%  28.39%  36.16%
head ranking  0.224458  18451.125498  16.33%  25.10%  28.59%  35.06%
mean ranking  0.219780  18849.887948  15.69%  24.25%  28.49%  35.61%
Ellipsis
Validation time:  250s
Epoch 14: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:20<00:00,  2.92it/s, loss=0.255]
Total time: 1100s, loss: 0.2440
--------------------------------------------------
Epoch 14: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:20<00:00,  2.92it/s, loss=0.255]
Epoch:   15,
Epoch 15:  92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [14:10<01:12,  3.49it/s, loss=0.248]
Training time:  850s
Epoch 15: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:18<00:00,  2.93it/s, loss=0.248]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.199007  18708.543825  13.65%  21.31%  25.80%  33.07%
head ranking  0.244063  18695.286853  19.12%  26.59%  30.08%  35.06%
mean ranking  0.221535  18701.915339  16.38%  23.95%  27.94%  34.06%
Ellipsis
Validation time:  248s
Epoch 15: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:18<00:00,  2.93it/s, loss=0.248]
Total time: 1098s, loss: 0.2387
--------------------------------------------------
Epoch 15: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:18<00:00,  2.93it/s, loss=0.248]
Epoch:   16,
Epoch 16:  92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [14:08<01:12,  3.49it/s, loss=0.253]
Training time:  848s
Epoch 16: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:16<00:00,  2.93it/s, loss=0.253]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.208034  18602.278884  14.54%  22.91%  27.49%  35.46%
head ranking  0.243527  18061.110558  17.93%  26.20%  30.98%  38.94%
mean ranking  0.225780  18331.694721  16.24%  24.55%  29.23%  37.20%
Ellipsis
Validation time:  247s
Epoch 16: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:16<00:00,  2.93it/s, loss=0.253]
Total time: 1096s, loss: 0.2343
--------------------------------------------------
Epoch 16: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:16<00:00,  2.93it/s, loss=0.253]
Epoch:   17,
Epoch 17:  92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [14:08<01:12,  3.49it/s, loss=0.234]
Training time:  849s
Epoch 17: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:19<00:00,  2.93it/s, loss=0.234]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.194608  19042.090637  12.95%  21.22%  26.29%  34.66%
head ranking  0.249349  16880.451195  17.93%  27.29%  32.57%  40.84%
mean ranking  0.221978  17961.270916  15.44%  24.25%  29.43%  37.75%
Ellipsis
Validation time:  250s
Epoch 17: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:19<00:00,  2.93it/s, loss=0.234]
Total time: 1099s, loss: 0.2291
--------------------------------------------------
Epoch 17: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:19<00:00,  2.93it/s, loss=0.234]
Epoch:   18,
Epoch 18:  92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [14:09<01:12,  3.49it/s, loss=0.226]
Training time:  849s
Epoch 18: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:16<00:00,  2.93it/s, loss=0.226]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.216255  19527.294821  16.04%  23.21%  27.29%  35.46%
head ranking  0.234733  20168.587649  18.73%  25.40%  28.69%  33.67%
mean ranking  0.225494  19847.941235  17.38%  24.30%  27.99%  34.56%
Ellipsis
Validation time:  247s
Epoch 18: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:16<00:00,  2.93it/s, loss=0.226]
Total time: 1096s, loss: 0.2252
--------------------------------------------------
Epoch 18: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:16<00:00,  2.93it/s, loss=0.226]
Epoch:   19,
Epoch 19:  92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [14:09<01:12,  3.49it/s, loss=0.235]
Training time:  849s
Epoch 19: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:21<00:00,  2.92it/s, loss=0.235]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.215522  18065.344622  15.44%  24.10%  28.29%  33.47%
head ranking  0.232896  18459.107570  17.43%  25.20%  29.38%  36.16%
mean ranking  0.224209  18262.226096  16.43%  24.65%  28.83%  34.81%
Ellipsis
Validation time:  251s
Epoch 19: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:21<00:00,  2.92it/s, loss=0.235]
Total time: 1101s, loss: 0.2207
--------------------------------------------------
Epoch 19: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:21<00:00,  2.92it/s, loss=0.235]
Epoch:   20,
Epoch 20:  92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [14:08<01:12,  3.49it/s, loss=0.223]
Training time:  848s
Epoch 20: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:18<00:00,  2.93it/s, loss=0.223]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.215435  19495.620518  15.04%  24.10%  28.29%  35.36%
head ranking  0.242166  18139.327689  18.33%  25.90%  30.68%  37.95%
mean ranking  0.228800  18817.474104  16.68%  25.00%  29.48%  36.65%
Ellipsis
Validation time:  249s
Epoch 20: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:18<00:00,  2.93it/s, loss=0.223]
Total time: 1098s, loss: 0.2176
--------------------------------------------------
Epoch 20: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:18<00:00,  2.93it/s, loss=0.223]
Epoch:   21,
Epoch 21:  92%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                   | 2964/3216 [14:09<01:12,  3.49it/s, loss=0.23]
Training time:  849s
Epoch 21: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:08<00:00,  2.95it/s, loss=0.23]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.220642  18341.175299  15.34%  24.90%  28.88%  36.25%
head ranking  0.262924  17061.759960  20.02%  28.88%  32.67%  40.04%
mean ranking  0.241783  17701.467629  17.68%  26.89%  30.78%  38.15%
Ellipsis
Validation time:  238s
Epoch 21: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:08<00:00,  2.95it/s, loss=0.23]
Total time: 1088s, loss: 0.2143
--------------------------------------------------
Epoch 21: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:08<00:00,  2.95it/s, loss=0.23]
Epoch:   22,
Epoch 22:  92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [14:09<01:12,  3.49it/s, loss=0.224]
Training time:  849s
Epoch 22: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:13<00:00,  2.94it/s, loss=0.224]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.218393  18107.968127  15.74%  23.11%  29.38%  35.06%
head ranking  0.247757  17076.685259  17.93%  26.69%  31.67%  40.94%
mean ranking  0.233075  17592.326693  16.83%  24.90%  30.53%  38.00%
Ellipsis
Validation time:  243s
Epoch 22: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:13<00:00,  2.94it/s, loss=0.224]
Total time: 1093s, loss: 0.2108
--------------------------------------------------
Epoch 22: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:13<00:00,  2.94it/s, loss=0.224]
Epoch:   23,
Epoch 23:  92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [14:09<01:12,  3.49it/s, loss=0.219]
Training time:  849s
Epoch 23: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:09<00:00,  2.95it/s, loss=0.219]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.206147  17971.655378  12.75%  23.41%  28.98%  36.95%
head ranking  0.242887  17499.344622  17.63%  26.49%  31.47%  38.25%
mean ranking  0.224517  17735.500000  15.19%  24.95%  30.23%  37.60%
Ellipsis
Validation time:  239s
Epoch 23: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:09<00:00,  2.95it/s, loss=0.219]
Total time: 1089s, loss: 0.2081
--------------------------------------------------
Epoch 23: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:09<00:00,  2.95it/s, loss=0.219]
Epoch:   24,
Epoch 24:  92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [14:08<01:12,  3.49it/s, loss=0.218]
Training time:  848s
Epoch 24: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:16<00:00,  2.93it/s, loss=0.218]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.220719  17694.087649  15.94%  24.10%  28.88%  36.35%
head ranking  0.251741  17841.378486  18.82%  27.49%  32.27%  38.75%
mean ranking  0.236230  17767.733068  17.38%  25.80%  30.58%  37.55%
Ellipsis
Validation time:  248s
Epoch 24: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:16<00:00,  2.93it/s, loss=0.218]
Total time: 1096s, loss: 0.2066
--------------------------------------------------
Epoch 24: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:16<00:00,  2.93it/s, loss=0.218]
Epoch:   25,
Epoch 25:  92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [14:09<01:12,  3.49it/s, loss=0.206]
Training time:  849s
Epoch 25: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:18<00:00,  2.93it/s, loss=0.206]
                  mrr           mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.22481  18649.89741  16.04%  25.70%  29.98%  36.75%
head ranking  0.23151  19371.62251  16.83%  25.70%  29.48%  35.66%
mean ranking  0.22816  19010.75996  16.43%  25.70%  29.73%  36.21%
Ellipsis
Validation time:  249s
Epoch 25: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:18<00:00,  2.93it/s, loss=0.206]
Total time: 1098s, loss: 0.2039
--------------------------------------------------
Epoch 25: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:18<00:00,  2.93it/s, loss=0.206]
Epoch:   26,
Epoch 26:  92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [14:08<01:12,  3.49it/s, loss=0.208]
Training time:  848s
Epoch 26: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:12<00:00,  2.94it/s, loss=0.208]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.219523  20230.333665  15.84%  24.60%  28.09%  35.06%
head ranking  0.250829  18410.869522  18.33%  28.98%  33.17%  38.75%
mean ranking  0.235176  19320.601594  17.08%  26.79%  30.63%  36.90%
Ellipsis
Validation time:  243s
Epoch 26: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:12<00:00,  2.94it/s, loss=0.208]
Total time: 1092s, loss: 0.2021
--------------------------------------------------
Epoch 26: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:12<00:00,  2.94it/s, loss=0.208]
Epoch:   27,
Epoch 27:  92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [14:08<01:12,  3.49it/s, loss=0.204]
Training time:  848s
Epoch 27: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:16<00:00,  2.93it/s, loss=0.204]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.217058  19212.349602  15.44%  24.20%  28.49%  36.16%
head ranking  0.262989  18104.962151  21.02%  28.39%  31.77%  38.45%
mean ranking  0.240024  18658.655876  18.23%  26.29%  30.13%  37.30%
Ellipsis
Validation time:  248s
Epoch 27: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:16<00:00,  2.93it/s, loss=0.204]
Total time: 1096s, loss: 0.2001
--------------------------------------------------
Epoch 27: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:16<00:00,  2.93it/s, loss=0.204]
Epoch:   28,
Epoch 28:  92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [14:09<01:12,  3.49it/s, loss=0.202]
Training time:  849s
Epoch 28: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:12<00:00,  2.94it/s, loss=0.202]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.226413  19033.155378  16.33%  25.20%  28.69%  35.86%
head ranking  0.252932  18660.211155  19.32%  28.29%  31.47%  37.55%
mean ranking  0.239672  18846.683267  17.83%  26.74%  30.08%  36.70%
Ellipsis
Validation time:  242s
Epoch 28: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:12<00:00,  2.94it/s, loss=0.202]
Total time: 1092s, loss: 0.1981
--------------------------------------------------
Epoch 28: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:12<00:00,  2.94it/s, loss=0.202]
Epoch:   29,
Epoch 29:  92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [14:08<01:12,  3.49it/s, loss=0.212]
Training time:  848s
Epoch 29: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:09<00:00,  2.95it/s, loss=0.212]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.221843  18274.109562  15.04%  25.50%  30.28%  36.85%
head ranking  0.256826  18040.970120  20.12%  27.79%  31.27%  38.15%
mean ranking  0.239334  18157.539841  17.58%  26.64%  30.78%  37.50%
Ellipsis
Validation time:  241s
Epoch 29: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:09<00:00,  2.95it/s, loss=0.212]
Total time: 1089s, loss: 0.1967
--------------------------------------------------
Epoch 29: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:09<00:00,  2.95it/s, loss=0.212]
`Trainer.fit` stopped: `max_epochs=30` reached.
Epoch 29: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [18:09<00:00,  2.95it/s, loss=0.212]
model_path: [./checkpoint/NELL-2023-12-07 23:13:52.632393/NELL-epoch=028-val_mrr=0.2264.ckpt]
You are using a CUDA device ('NVIDIA RTX A6000') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Testing DataLoader 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 270/270 [04:04<00:00,  1.10it/s]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.303959  14813.439759  22.71%  34.38%  38.83%  46.01%
head ranking  0.309948  11793.218721  22.52%  34.20%  39.90%  49.35%
mean ranking  0.306954  13303.329240  22.61%  34.29%  39.37%  47.68%

==================================================
Epoch: test
Ellipsis
==================================================
Testing DataLoader 1: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 270/270 [04:04<00:00,  1.10it/s]
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
       Test metric             DataLoader 0             DataLoader 1
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
         val_mrr            0.3039590120315552       0.3039590120315552
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
(KG-S2S) chrisjihee@ptlm3:~/proj/KG-S2S$

