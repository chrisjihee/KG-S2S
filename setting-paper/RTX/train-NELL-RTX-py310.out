(KG-S2S) chris@chris137:/dat/proj/KG-S2S$ bash setting-paper/train-NELL.sh
Namespace(dataset_path='./data/processed', dataset='NELL', model='T5Finetuner', gpu='3', seed=41504, num_workers=4, save_dir='./checkpoint/NELL-2023-12-07 23:13:22.742927', pretrained_model='t5-base', batch_size=128, val_batch_size=8, num_beams=40, num_beam_groups=1, src_max_length=512, train_tgt_max_length=512, eval_tgt_max_length=25, epochs=30, lr=0.0005, diversity_penalty=0.0, model_path='', optim='Adam', decoder='beam_search', log_text=False, use_prefix_search=False, src_descrip_max_length=0, tgt_descrip_max_length=0, use_soft_prompt=True, use_rel_prompt_emb=True, skip_n_val_epoch=0, seq_dropout=0.0, temporal=False, n_ent=68544, n_rel=358, vocab_size=32128, model_dim=768)
Global seed set to 41504
tokenizing entities...
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 68544/68544 [00:28<00:00, 2391.34it/s]
datamodule construction done.

----------------------------------------------------------------------------------
 * pl.Trainer(accelerator=gpu, devices=[3])
----------------------------------------------------------------------------------

GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
model construction done.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]

  | Name                       | Type                               | Params
----------------------------------------------------------------------------------
0 | T5ForConditionalGeneration | ModifiedT5ForConditionalGeneration | 222 M
1 | rel_embed1                 | Embedding                          | 274 K
2 | rel_embed2                 | Embedding                          | 274 K
3 | rel_embed3                 | Embedding                          | 274 K
4 | rel_embed4                 | Embedding                          | 274 K
----------------------------------------------------------------------------------
224 M     Trainable params
0         Non-trainable params
224 M     Total params
896.013   Total estimated model params size (MB)
Training: 0it [00:00, ?it/s]Epoch:    0,
Epoch 0:  46%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                     Epoch 0:  46%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                     Epoch 0:  46%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                     Epoch 0:  46%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                                     Epoch 0:  46%|█████████████████████████████████████████████████████████████████████████████▌                                                                                          | 1484/3216 [09:29<11:05,  2.60it/s, loss=0.611]Epoch 0:  71%|████████████████████████████████████████████████████████████████████████████Epoch 0:  71%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████Epoch 0:  71%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                       Epoch 0:  71%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                       Epoch 0:  71%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                       Epoch 0:  71%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                       Epoch 0:  71%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                | 2296/3216 [14:44<05:54,  2.60it/s, loss=0.579]Epoch 0:  92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊             | 2964/3216 [19:02<01:37,  2.59it/s, loss=0.582]Training time: 1142s
Epoch 0: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [23:25<00:00,  2.29it/s, loss=0.582]
                   mrr            mr  hit@1   hit@3   hit@5  hit@10█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 126/126 [01:58<00:00,  1.06it/s]
tail ranking  0.138719  22785.239044  8.86%  14.84%  19.32%  26.10%
head ranking  0.147752  22724.094622  8.96%  17.63%  21.41%  26.79%
mean ranking  0.143236  22754.666833  8.91%  16.24%  20.37%  26.44%
Ellipsis
Validation time:  262s
Epoch 0: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [23:25<00:00,  2.29it/s, loss=0.582]
Total time: 1405s, loss: 0.6437
--------------------------------------------------
Epoch 0: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [23:25<00:00,  2.29it/s, loss=0.582]Epoch:    1,
Epoch 1:  92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊             | 2964/3216 [19:06<01:37,  2.58it/s, loss=0.498]Training time: 1146s
Epoch 1: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [23:23<00:00,  2.29it/s, loss=0.498]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 126/126 [02:24<00:00,  1.15s/it]
tail ranking  0.130691  20411.844622   6.57%  14.04%  20.52%  28.29%
head ranking  0.182591  19943.396414  11.35%  20.52%  26.10%  34.56%
mean ranking  0.156641  20177.620518   8.96%  17.28%  23.31%  31.42%
Ellipsis
Validation time:  256s
Epoch 1: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [23:23<00:00,  2.29it/s, loss=0.498]
Total time: 1403s, loss: 0.5167
--------------------------------------------------
Epoch 1: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [23:23<00:00,  2.29it/s, loss=0.498]Epoch:    2,
Epoch 2:  92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊             | 2964/3216 [19:06<01:37,  2.59it/s, loss=0.463]Training time: 1146s
Epoch 2: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [23:33<00:00,  2.28it/s, loss=0.463]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 126/126 [01:55<00:00,  1.09it/s]
tail ranking  0.149416  20341.804781   8.67%  16.73%  21.51%  29.28%
head ranking  0.186865  18554.316733  12.95%  19.82%  23.31%  32.77%
mean ranking  0.168140  19448.060757  10.81%  18.28%  22.41%  31.03%
Ellipsis
Validation time:  267s
Epoch 2: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [23:33<00:00,  2.28it/s, loss=0.463]
Total time: 1413s, loss: 0.4583
--------------------------------------------------
Epoch 2: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [23:33<00:00,  2.28it/s, loss=0.463]Epoch:    3,
Epoch 3:  92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊             | 2964/3216 [19:05<01:37,  2.59it/s, loss=0.426]Training time: 1145s
Epoch 3: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:56<00:00,  2.34it/s, loss=0.426]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 126/126 [01:52<00:00,  1.12it/s]
tail ranking  0.150019  20225.441235   8.76%  16.73%  22.01%  29.18%
head ranking  0.186715  17877.500000  12.45%  19.42%  24.70%  32.77%
mean ranking  0.168367  19051.470618  10.61%  18.08%  23.36%  30.98%
Ellipsis
Validation time:  230s
Epoch 3: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:56<00:00,  2.34it/s, loss=0.426]
Total time: 1376s, loss: 0.4169
--------------------------------------------------
Epoch 3: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:56<00:00,  2.34it/s, loss=0.426]Epoch:    4,
Epoch 4:  92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊             | 2964/3216 [19:03<01:37,  2.59it/s, loss=0.388]Training time: 1143s
Epoch 4: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [23:00<00:00,  2.33it/s, loss=0.388]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 126/126 [01:57<00:00,  1.07it/s]
tail ranking  0.169297  21016.941235  11.06%  19.02%  23.41%  30.28%
head ranking  0.194744  19068.946215  12.95%  21.22%  26.89%  35.66%
mean ranking  0.182021  20042.943725  12.00%  20.12%  25.15%  32.97%
Ellipsis
Validation time:  237s
Epoch 4: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [23:00<00:00,  2.33it/s, loss=0.388]
Total time: 1380s, loss: 0.3844
--------------------------------------------------
Epoch 4: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [23:00<00:00,  2.33it/s, loss=0.388]Epoch:    5,
Epoch 5:  92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊             | 2964/3216 [19:06<01:37,  2.59it/s, loss=0.361]Training time: 1146s
Epoch 5: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [23:02<00:00,  2.33it/s, loss=0.361]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 126/126 [01:57<00:00,  1.07it/s]
tail ranking  0.176289  20595.277888  11.55%  20.22%  24.00%  29.68%
head ranking  0.184001  19592.878486  12.35%  19.72%  23.90%  32.57%
mean ranking  0.180145  20094.078187  11.95%  19.97%  23.95%  31.13%
Ellipsis
Validation time:  236s
Epoch 5: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [23:02<00:00,  2.33it/s, loss=0.361]
Total time: 1382s, loss: 0.3584
--------------------------------------------------
Epoch 5: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [23:02<00:00,  2.33it/s, loss=0.361]Epoch:    6,
Epoch 6:  92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                   | 2964/3216 [19:04<01:37,  2.59it/s, loss=0.329]Training time: 1145s
Epoch 6: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:57<00:00,  2.33it/s, loss=0.329]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 126/126 [01:55<00:00,  1.09it/s]
tail ranking  0.183668  19608.256972  12.75%  19.42%  24.50%  31.87%
head ranking  0.207668  17932.228088  14.64%  21.31%  27.09%  35.96%
mean ranking  0.195668  18770.242530  13.70%  20.37%  25.80%  33.91%
Ellipsis
Validation time:  232s
Epoch 6: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:57<00:00,  2.33it/s, loss=0.329]
Total time: 1377s, loss: 0.3366
--------------------------------------------------
Epoch 6: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:57<00:00,  2.33it/s, loss=0.329]Epoch:    7,
Epoch 7:  92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                   | 2964/3216 [19:02<01:37,  2.59it/s, loss=0.319]Training time: 1142s
Epoch 7: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:55<00:00,  2.34it/s, loss=0.319]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 126/126 [01:55<00:00,  1.09it/s]
tail ranking  0.177801  20318.115538  11.85%  19.82%  23.90%  31.18%
head ranking  0.217310  19245.315737  15.44%  23.41%  28.78%  35.06%
mean ranking  0.197555  19781.715637  13.65%  21.61%  26.34%  33.12%
Ellipsis
Validation time:  232s
Epoch 7: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:55<00:00,  2.34it/s, loss=0.319]
Total time: 1375s, loss: 0.3179
--------------------------------------------------
Epoch 7: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:55<00:00,  2.34it/s, loss=0.319]Epoch:    8,
Epoch 8:  92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                   | 2964/3216 [19:04<01:37,  2.59it/s, loss=0.303]Training time: 1144s
Epoch 8: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:51<00:00,  2.34it/s, loss=0.303]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 126/126 [01:52<00:00,  1.12it/s]
tail ranking  0.184948  20188.179283  11.55%  21.12%  26.00%  31.47%
head ranking  0.205629  19466.975100  14.34%  22.31%  27.59%  33.67%
mean ranking  0.195288  19827.577191  12.95%  21.71%  26.79%  32.57%
Ellipsis
Validation time:  227s
Epoch 8: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:51<00:00,  2.34it/s, loss=0.303]
Total time: 1371s, loss: 0.3023
--------------------------------------------------
Epoch 8: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:51<00:00,  2.34it/s, loss=0.303]Epoch:    9,
Epoch 9:  92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                   | 2964/3216 [19:02<01:37,  2.59it/s, loss=0.308]Training time: 1142s
Epoch 9: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:50<00:00,  2.35it/s, loss=0.308]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 126/126 [01:53<00:00,  1.11it/s]
tail ranking  0.198511  19721.892430  14.24%  21.51%  25.10%  32.67%
head ranking  0.202726  19928.337649  14.34%  22.61%  26.49%  32.17%
mean ranking  0.200618  19825.115040  14.29%  22.06%  25.80%  32.42%
Ellipsis
Validation time:  227s
Epoch 9: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:50<00:00,  2.35it/s, loss=0.308]
Total time: 1370s, loss: 0.2894
--------------------------------------------------
Epoch 9: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:50<00:00,  2.35it/s, loss=0.308]Epoch:   10,
Epoch 10:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [19:03<01:37,  2.59it/s, loss=0.298]Training time: 1143s
Epoch 10: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:54<00:00,  2.34it/s, loss=0.298]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 126/126 [01:52<00:00,  1.12it/s]
tail ranking  0.199433  18951.744024  13.45%  20.92%  27.39%  35.16%
head ranking  0.220224  19750.057769  14.94%  26.10%  28.98%  36.55%
mean ranking  0.209828  19350.900896  14.19%  23.51%  28.19%  35.86%
Ellipsis
Validation time:  230s
Epoch 10: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:54<00:00,  2.34it/s, loss=0.298]
Total time: 1374s, loss: 0.2777
--------------------------------------------------
Epoch 10: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:54<00:00,  2.34it/s, loss=0.298]Epoch:   11,
Epoch 11:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [19:02<01:37,  2.60it/s, loss=0.279]Training time: 1142s
Epoch 11: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:49<00:00,  2.35it/s, loss=0.279]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 126/126 [01:51<00:00,  1.13it/s]
tail ranking  0.199388  20346.985060  12.95%  23.21%  27.99%  34.56%
head ranking  0.206999  18300.433267  13.84%  23.01%  27.69%  35.86%
mean ranking  0.203194  19323.709163  13.40%  23.11%  27.84%  35.21%
Ellipsis
Validation time:  227s
Epoch 11: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:49<00:00,  2.35it/s, loss=0.279]
Total time: 1369s, loss: 0.2682
--------------------------------------------------
Epoch 11: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:49<00:00,  2.35it/s, loss=0.279]Epoch:   12,
Epoch 12:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [19:03<01:37,  2.59it/s, loss=0.263]Training time: 1143s
Epoch 12: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [23:27<00:00,  2.28it/s, loss=0.263]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 126/126 [01:55<00:00,  1.09it/s]
tail ranking  0.222862  19058.377490  16.14%  24.70%  28.69%  35.56%
head ranking  0.214425  18560.871514  15.94%  23.11%  27.19%  33.47%
mean ranking  0.218644  18809.624502  16.04%  23.90%  27.94%  34.51%
Ellipsis
Validation time:  263s
Epoch 12: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [23:27<00:00,  2.28it/s, loss=0.263]
Total time: 1407s, loss: 0.2609
--------------------------------------------------
Epoch 12: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [23:27<00:00,  2.28it/s, loss=0.263]Epoch:   13,
Epoch 13:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [19:02<01:37,  2.59it/s, loss=0.263]Training time: 1142s
Epoch 13: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:48<00:00,  2.35it/s, loss=0.263]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 126/126 [01:50<00:00,  1.14it/s]
tail ranking  0.222647  18859.624502  15.74%  24.90%  29.78%  35.36%
head ranking  0.239185  18733.813745  18.13%  25.40%  30.88%  37.25%
mean ranking  0.230916  18796.719124  16.93%  25.15%  30.33%  36.30%
Ellipsis
Validation time:  225s
Epoch 13: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:48<00:00,  2.35it/s, loss=0.263]
Total time: 1368s, loss: 0.2524
--------------------------------------------------
Epoch 13: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:48<00:00,  2.35it/s, loss=0.263]Epoch:   14,
Epoch 14:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [19:04<01:37,  2.59it/s, loss=0.253]Training time: 1145s
Epoch 14: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [23:01<00:00,  2.33it/s, loss=0.253]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 126/126 [01:56<00:00,  1.08it/s]
tail ranking  0.213736  17955.558765  14.54%  24.20%  27.79%  36.35%
head ranking  0.222646  18828.058765  16.73%  23.41%  28.09%  35.46%
mean ranking  0.218191  18391.808765  15.64%  23.80%  27.94%  35.91%
Ellipsis
Validation time:  236s
Epoch 14: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [23:01<00:00,  2.33it/s, loss=0.253]
Total time: 1381s, loss: 0.2451
--------------------------------------------------
Epoch 14: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [23:01<00:00,  2.33it/s, loss=0.253]Epoch:   15,
Epoch 15:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [19:03<01:37,  2.59it/s, loss=0.247]Training time: 1143s
Epoch 15: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:56<00:00,  2.34it/s, loss=0.247]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 126/126 [01:54<00:00,  1.10it/s]
tail ranking  0.207627  17659.369522  13.75%  23.41%  28.88%  36.06%
head ranking  0.213290  18879.997012  15.34%  22.91%  27.79%  33.76%
mean ranking  0.210458  18269.683267  14.54%  23.16%  28.34%  34.91%
Ellipsis
Validation time:  232s
Epoch 15: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:56<00:00,  2.34it/s, loss=0.247]
Total time: 1376s, loss: 0.2392
--------------------------------------------------
Epoch 15: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:56<00:00,  2.34it/s, loss=0.247]Epoch:   16,
Epoch 16:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [19:01<01:37,  2.60it/s, loss=0.258]Training time: 1141s
Epoch 16: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:54<00:00,  2.34it/s, loss=0.258]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 126/126 [01:56<00:00,  1.08it/s]
tail ranking  0.214692  19669.798805  14.74%  24.60%  29.08%  35.46%
head ranking  0.228361  19199.827689  16.73%  25.40%  29.18%  37.05%
mean ranking  0.221527  19434.813247  15.74%  25.00%  29.13%  36.25%
Ellipsis
Validation time:  233s
Epoch 16: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:54<00:00,  2.34it/s, loss=0.258]
Total time: 1374s, loss: 0.2345
--------------------------------------------------
Epoch 16: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:54<00:00,  2.34it/s, loss=0.258]Epoch:   17,
Epoch 17:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [19:02<01:37,  2.60it/s, loss=0.234]Training time: 1142s
Epoch 17: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:48<00:00,  2.35it/s, loss=0.234]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 126/126 [01:51<00:00,  1.13it/s]
tail ranking  0.212111  18973.213147  15.04%  23.80%  27.39%  35.26%
head ranking  0.224334  19521.830677  16.83%  23.11%  28.88%  36.06%
mean ranking  0.218222  19247.521912  15.94%  23.46%  28.14%  35.66%
Ellipsis
Validation time:  226s
Epoch 17: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:48<00:00,  2.35it/s, loss=0.234]
Total time: 1368s, loss: 0.2296
--------------------------------------------------
Epoch 17: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:48<00:00,  2.35it/s, loss=0.234]Epoch:   18,
Epoch 18:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [19:03<01:37,  2.59it/s, loss=0.231]Training time: 1143s
Epoch 18: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:50<00:00,  2.35it/s, loss=0.231]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 126/126 [01:49<00:00,  1.15it/s]
tail ranking  0.214757  18334.478088  15.54%  22.91%  26.89%  35.46%
head ranking  0.211573  19042.914343  15.84%  23.11%  26.29%  31.57%
mean ranking  0.213165  18688.696215  15.69%  23.01%  26.59%  33.52%
Ellipsis
Validation time:  226s
Epoch 18: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:50<00:00,  2.35it/s, loss=0.231]
Total time: 1370s, loss: 0.2253
--------------------------------------------------
Epoch 18: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:50<00:00,  2.35it/s, loss=0.231]Epoch:   19,
Epoch 19:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [19:03<01:37,  2.59it/s, loss=0.229]Training time: 1143s
Epoch 19: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:54<00:00,  2.34it/s, loss=0.229]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 126/126 [01:53<00:00,  1.11it/s]
tail ranking  0.218618  18326.647410  15.24%  24.30%  28.29%  36.95%
head ranking  0.230537  19470.221116  17.03%  25.00%  29.88%  36.65%
mean ranking  0.224578  18898.434263  16.14%  24.65%  29.08%  36.80%
Ellipsis
Validation time:  230s
Epoch 19: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:54<00:00,  2.34it/s, loss=0.229]
Total time: 1374s, loss: 0.2206
--------------------------------------------------
Epoch 19: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:54<00:00,  2.34it/s, loss=0.229]Epoch:   20,
Epoch 20:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [19:01<01:37,  2.60it/s, loss=0.224]Training time: 1141s
Epoch 20: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [23:15<00:00,  2.30it/s, loss=0.224]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 126/126 [02:19<00:00,  1.10s/it]
tail ranking  0.211411  18465.278884  14.24%  24.30%  28.49%  35.46%
head ranking  0.223977  18832.928287  15.74%  25.50%  29.28%  35.86%
mean ranking  0.217694  18649.103586  14.99%  24.90%  28.88%  35.66%
Ellipsis
Validation time:  254s
Epoch 20: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [23:15<00:00,  2.30it/s, loss=0.224]
Total time: 1395s, loss: 0.2180
--------------------------------------------------
Epoch 20: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [23:15<00:00,  2.30it/s, loss=0.224]Epoch:   21,
Epoch 21:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [19:02<01:37,  2.59it/s, loss=0.231]Training time: 1143s
Epoch 21: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:51<00:00,  2.35it/s, loss=0.231]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 126/126 [01:51<00:00,  1.13it/s]
tail ranking  0.221070  17876.465139  15.94%  24.40%  28.39%  35.36%
head ranking  0.222798  17699.141434  15.64%  23.41%  29.48%  38.65%
mean ranking  0.221934  17787.803287  15.79%  23.90%  28.93%  37.00%
Ellipsis
Validation time:  228s
Epoch 21: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:51<00:00,  2.35it/s, loss=0.231]
Total time: 1371s, loss: 0.2146
--------------------------------------------------
Epoch 21: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:51<00:00,  2.35it/s, loss=0.231]Epoch:   22,
Epoch 22:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [19:04<01:37,  2.59it/s, loss=0.227]Training time: 1144s
Epoch 22: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:55<00:00,  2.34it/s, loss=0.227]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 126/126 [01:54<00:00,  1.10it/s]
tail ranking  0.218556  18635.348606  15.24%  24.00%  29.78%  36.55%
head ranking  0.246830  17331.932271  17.93%  27.89%  31.57%  39.64%
mean ranking  0.232693  17983.640438  16.58%  25.95%  30.68%  38.10%
Ellipsis
Validation time:  231s
Epoch 22: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:55<00:00,  2.34it/s, loss=0.227]
Total time: 1375s, loss: 0.2111
--------------------------------------------------
Epoch 22: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:55<00:00,  2.34it/s, loss=0.227]Epoch:   23,
Epoch 23:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [19:03<01:37,  2.59it/s, loss=0.214]Training time: 1143s
Epoch 23: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:49<00:00,  2.35it/s, loss=0.214]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 126/126 [01:48<00:00,  1.16it/s]
tail ranking  0.224103  17865.539841  15.64%  24.00%  30.98%  37.35%
head ranking  0.244681  17894.708167  18.43%  26.29%  31.77%  38.65%
mean ranking  0.234392  17880.124004  17.03%  25.15%  31.37%  38.00%
Ellipsis
Validation time:  225s
Epoch 23: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:49<00:00,  2.35it/s, loss=0.214]
Total time: 1369s, loss: 0.2086
--------------------------------------------------
Epoch 23: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:49<00:00,  2.35it/s, loss=0.214]Epoch:   24,
Epoch 24:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [19:04<01:37,  2.59it/s, loss=0.223]Training time: 1145s
Epoch 24: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:57<00:00,  2.33it/s, loss=0.223]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 126/126 [01:53<00:00,  1.11it/s]
tail ranking  0.217420  18159.430279  15.74%  23.41%  27.99%  34.86%
head ranking  0.237911  19705.941235  17.83%  26.00%  32.17%  37.45%
mean ranking  0.227666  18932.685757  16.78%  24.70%  30.08%  36.16%
Ellipsis
Validation time:  232s
Epoch 24: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:57<00:00,  2.33it/s, loss=0.223]
Total time: 1377s, loss: 0.2069
--------------------------------------------------
Epoch 24: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:57<00:00,  2.33it/s, loss=0.223]Epoch:   25,
Epoch 25:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [19:04<01:37,  2.59it/s, loss=0.209]Training time: 1144s
Epoch 25: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:55<00:00,  2.34it/s, loss=0.209]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 126/126 [01:52<00:00,  1.12it/s]
tail ranking  0.220568  19132.486056  15.14%  24.90%  30.48%  36.16%
head ranking  0.245627  18906.162351  18.33%  26.69%  31.47%  37.45%
mean ranking  0.233097  19019.324203  16.73%  25.80%  30.98%  36.80%
Ellipsis
Validation time:  231s
Epoch 25: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:55<00:00,  2.34it/s, loss=0.209]
Total time: 1375s, loss: 0.2040
--------------------------------------------------
Epoch 25: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:55<00:00,  2.34it/s, loss=0.209]Epoch:   26,
Epoch 26:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [19:05<01:37,  2.59it/s, loss=0.214]Training time: 1145s
Epoch 26: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [23:19<00:00,  2.30it/s, loss=0.214]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 126/126 [02:15<00:00,  1.07s/it]
tail ranking  0.235563  17212.590637  16.83%  26.10%  31.47%  37.85%
head ranking  0.238966  18116.542829  16.14%  27.69%  33.47%  40.64%
mean ranking  0.237264  17664.566733  16.48%  26.89%  32.47%  39.24%
Ellipsis
Validation time:  254s
Epoch 26: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [23:19<00:00,  2.30it/s, loss=0.214]
Total time: 1399s, loss: 0.2023
--------------------------------------------------
Epoch 26: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [23:19<00:00,  2.30it/s, loss=0.214]Epoch:   27,
Epoch 27:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [19:06<01:37,  2.58it/s, loss=0.204]Training time: 1146s
Epoch 27: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:55<00:00,  2.34it/s, loss=0.204]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 126/126 [01:53<00:00,  1.11it/s]
tail ranking  0.236592  17867.796813  16.93%  27.69%  30.58%  38.75%
head ranking  0.224092  20298.119522  16.53%  24.20%  29.38%  36.35%
mean ranking  0.230342  19082.958167  16.73%  25.95%  29.98%  37.55%
Ellipsis
Validation time:  228s
Epoch 27: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:55<00:00,  2.34it/s, loss=0.204]
Total time: 1375s, loss: 0.2002
--------------------------------------------------
Epoch 27: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:55<00:00,  2.34it/s, loss=0.204]Epoch:   28,
Epoch 28:  92%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                   | 2964/3216 [19:06<01:37,  2.58it/s, loss=0.204]Training time: 1147s
Epoch 28: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:56<00:00,  2.34it/s, loss=0.204]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 126/126 [01:52<00:00,  1.12it/s]
tail ranking  0.238342  18378.432271  17.93%  25.10%  29.68%  37.45%
head ranking  0.229493  18003.418327  16.53%  24.90%  29.98%  36.55%
mean ranking  0.233917  18190.925299  17.23%  25.00%  29.83%  37.00%
Ellipsis
Validation time:  229s
Epoch 28: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:56<00:00,  2.34it/s, loss=0.204]
Total time: 1376s, loss: 0.1984
--------------------------------------------------
Epoch 28: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:56<00:00,  2.34it/s, loss=0.204]Epoch:   29,
Epoch 29:  92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                   | 2964/3216 [19:03<01:37,  2.59it/s, loss=0.21]Training time: 1144s
Epoch 29: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:48<00:00,  2.35it/s, loss=0.21]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 126/126 [01:48<00:00,  1.16it/s]
tail ranking  0.240833  18342.614542  17.33%  27.39%  31.87%  38.25%
head ranking  0.226298  20014.807769  17.03%  25.10%  29.28%  34.56%
mean ranking  0.233566  19178.711155  17.18%  26.25%  30.58%  36.40%
Ellipsis
Validation time:  224s
Epoch 29: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:48<00:00,  2.35it/s, loss=0.21]
Total time: 1368s, loss: 0.1977
--------------------------------------------------
Epoch 29: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [22:48<00:00,  2.35it/s, loss=0.21]`Trainer.fit` stopped: `max_epochs=30` reached.
Epoch 29: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3216/3216 [23:06<00:00,  2.32it/s, loss=0.21]
model_path: [./checkpoint/NELL-2023-12-07 23:13:22.742927/NELL-epoch=029-val_mrr=0.2408.ckpt]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3]
Testing DataLoader 1: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 270/270 [03:59<00:00,  1.13it/s]
                   mrr            mr   hit@1   hit@3   hit@5  hit@10
tail ranking  0.271917  15392.129286  19.18%  31.19%  35.63%  44.02%
head ranking  0.305084  12936.214087  21.27%  34.48%  40.69%  50.37%
mean ranking  0.288501  14164.171687  20.23%  32.83%  38.16%  47.20%

==================================================
Epoch: test
Ellipsis
==================================================
Testing DataLoader 1: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 270/270 [03:59<00:00,  1.13it/s]
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
       Test metric             DataLoader 0             DataLoader 1
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
         val_mrr            0.27191677689552307      0.27191677689552307
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
(KG-S2S) chris@chris137:/dat/proj/KG-S2S$

