(KG-S2S) chrisjihee@dgx-a100:~/proj/KG-S2S$ bash train-FB15k-237N.sh
Namespace(batch_size=32, dataset='FB15k-237N', dataset_path='./data/processed', decoder='beam_search', diversity_penalty=0.0, epochs=50, eval_tgt_max_length=30, gpu='2', log_text=False, lr=0.001, model='T5Finetuner', model_dim=768, model_path='', n_ent=14541, n_rel=93, num_beam_groups=1, num_beams=40, num_workers=4, optim='Adam', pretrained_model='t5-base', save_dir='./checkpoint/FB15k-237N-2023-12-01 00:47:25.667747', seed=41504, seq_dropout=0.2, skip_n_val_epoch=30, src_descrip_max_length=80, src_max_length=512, temporal=False, tgt_descrip_max_length=80, train_tgt_max_length=512, use_prefix_search=False, use_rel_prompt_emb=True, use_soft_prompt=True, val_batch_size=8, vocab_size=32128)
Global seed set to 41504
tokenizing entities...
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 14541/14541 [01:26<00:00, 168.60it/s]
datamodule construction done.
GPU available: True, used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
model construction done.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3,4,5,6,7]

  | Name                       | Type                               | Params
----------------------------------------------------------------------------------
0 | T5ForConditionalGeneration | ModifiedT5ForConditionalGeneration | 222 M
1 | rel_embed1                 | Embedding                          | 71.4 K
2 | rel_embed2                 | Embedding                          | 71.4 K
3 | rel_embed3                 | Embedding                          | 71.4 K
4 | rel_embed4                 | Embedding                          | 71.4 K
----------------------------------------------------------------------------------
223 M     Trainable params
0         Non-trainable params
223 M     Total params
892.757   Total estimated model params size (MB)
Training: 0it [00:00, ?it/s]Epoch:    0,
Epoch 0: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5456/5456 [12:24<00:00,  7.33it/s, loss=0.759]Total time:  744s, loss: 1.1162
--------------------------------------------------
Epoch:    1,
Epoch 1: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5456/5456 [12:23<00:00,  7.34it/s, loss=0.516]Total time:  743s, loss: 0.5997
--------------------------------------------------
Epoch:    2,
Epoch 2:  76%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                            | 5456/7218 [12:21<03:59,  7.35it/s, loss=0.339]Training time:  741s
Epoch 2: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊| 7211/7218 [12:26<00:00,  9.66it/s, loss=0.339]
Ellipsisng: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋| 1760/1762 [00:04<00:00, 486.28it/s]
Validation time:    4s
Epoch 2: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7218/7218 [12:26<00:00,  9.67it/s, loss=0.339]
Total time:  746s, loss: 0.4044
--------------------------------------------------
Epoch:    3,
Epoch 3: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5456/5456 [12:24<00:00,  7.33it/s, loss=0.271]Total time:  744s, loss: 0.3041
--------------------------------------------------
Epoch:    4,
Epoch 4: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5456/5456 [12:18<00:00,  7.39it/s, loss=0.209]Total time:  738s, loss: 0.2441
--------------------------------------------------
Epoch:    5,
Epoch 5:  76%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                            | 5456/7218 [12:17<03:58,  7.40it/s, loss=0.183]Training time:  737s
Epoch 5: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌| 7204/7218 [12:21<00:01,  9.71it/s, loss=0.183]
Ellipsisng: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌| 1759/1762 [00:04<00:00, 552.57it/s]
Validation time:    4s
Epoch 5: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7218/7218 [12:21<00:00,  9.73it/s, loss=0.183]
Total time:  741s, loss: 0.2046
--------------------------------------------------
Epoch:    6,
Epoch 6: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5456/5456 [12:15<00:00,  7.42it/s, loss=0.184]Total time:  735s, loss: 0.1766
--------------------------------------------------
Epoch:    7,
Epoch 7: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5456/5456 [12:16<00:00,  7.41it/s, loss=0.161]Total time:  736s, loss: 0.1563
--------------------------------------------------
Epoch:    8,
Epoch 8:  76%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                            | 5456/7218 [12:17<03:58,  7.40it/s, loss=0.161]Training time:  737s
Epoch 8: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎| 7198/7218 [12:21<00:02,  9.71it/s, loss=0.161]
Ellipsisng: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1762/1762 [00:04<00:00, 366.00it/s]
Validation time:    4s
Epoch 8: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7218/7218 [12:21<00:00,  9.73it/s, loss=0.161]
Total time:  741s, loss: 0.1409
--------------------------------------------------
Epoch:    9,
Epoch 9: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5456/5456 [12:19<00:00,  7.38it/s, loss=0.123]Total time:  739s, loss: 0.1294
--------------------------------------------------
Epoch:   10,
Epoch 10: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5456/5456 [12:20<00:00,  7.37it/s, loss=0.119]Total time:  740s, loss: 0.1201
--------------------------------------------------
Epoch:   11,
Epoch 11:  76%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                            | 5456/7218 [12:20<03:59,  7.37it/s, loss=0.113]Training time:  740s
Epoch 11: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎| 7198/7218 [12:25<00:02,  9.66it/s, loss=0.113]Ellipsisng:  99%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏   | 1736/1762 [00:04<00:00, 528.49it/s]
Validation time:    4s
Epoch 11: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7218/7218 [12:25<00:00,  9.69it/s, loss=0.113]
Total time:  745s, loss: 0.1124
--------------------------------------------------
Epoch:   12,
Epoch 12: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5456/5456 [12:20<00:00,  7.36it/s, loss=0.117]Total time:  740s, loss: 0.1060
--------------------------------------------------
Epoch:   13,
Epoch 13: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5456/5456 [12:22<00:00,  7.34it/s, loss=0.103]Total time:  742s, loss: 0.1009
--------------------------------------------------
Epoch:   14,
Epoch 14:  76%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                            | 5456/7218 [12:23<04:00,  7.34it/s, loss=0.0995]Training time:  743s
Epoch 14: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎| 7198/7218 [12:27<00:02,  9.62it/s, loss=0.0995]
Ellipsisng:  99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊  | 1747/1762 [00:04<00:00, 526.79it/s]
Validation time:    4s
Epoch 14: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7218/7218 [12:28<00:00,  9.65it/s, loss=0.0995]
Total time:  748s, loss: 0.0963
--------------------------------------------------
Epoch:   15,
Epoch 15: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5456/5456 [12:17<00:00,  7.40it/s, loss=0.1]Total time:  737s, loss: 0.0925
--------------------------------------------------
Epoch:   16,
Epoch 16: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5456/5456 [12:19<00:00,  7.37it/s, loss=0.0923]Total time:  739s, loss: 0.0890
--------------------------------------------------
Epoch:   17,
Epoch 17:  76%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                            | 5456/7218 [12:24<04:00,  7.33it/s, loss=0.0853]Training time:  744s
Epoch 17: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎| 7198/7218 [12:29<00:02,  9.61it/s, loss=0.0853]Ellipsisng:  97%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎      | 1716/1762 [00:04<00:00, 462.12it/s]
Validation time:    5s
Epoch 17: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7218/7218 [12:29<00:00,  9.63it/s, loss=0.0853]
Total time:  749s, loss: 0.0860
--------------------------------------------------
Epoch:   18,
Epoch 18: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5456/5456 [12:23<00:00,  7.34it/s, loss=0.0812]Total time:  743s, loss: 0.0833
--------------------------------------------------
Epoch:   19,
Epoch 19: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5456/5456 [12:23<00:00,  7.34it/s, loss=0.0832]Total time:  743s, loss: 0.0809
--------------------------------------------------
Epoch:   20,
Epoch 20:  76%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                            | 5456/7218 [12:21<03:59,  7.36it/s, loss=0.076]Training time:  741s
Epoch 20: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎| 7198/7218 [12:26<00:02,  9.64it/s, loss=0.076]Ellipsisng:  99%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉   | 1741/1762 [00:04<00:00, 433.62it/s]
Validation time:    5s
Epoch 20: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7218/7218 [12:26<00:00,  9.67it/s, loss=0.076]
Total time:  746s, loss: 0.0786
--------------------------------------------------
Epoch:   21,
Epoch 21: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5456/5456 [12:20<00:00,  7.36it/s, loss=0.0768]Total time:  740s, loss: 0.0765
--------------------------------------------------
Epoch:   22,
Epoch 22: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5456/5456 [12:21<00:00,  7.36it/s, loss=0.083]Total time:  741s, loss: 0.0747
--------------------------------------------------
Epoch:   23,
Epoch 23:  76%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                            | 5456/7218 [12:23<04:00,  7.34it/s, loss=0.0758]Training time:  743s
Epoch 23: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎| 7198/7218 [12:27<00:02,  9.62it/s, loss=0.0758]Ellipsisng:  97%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏      | 1715/1762 [00:04<00:00, 522.74it/s]
Validation time:    4s
Epoch 23: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7218/7218 [12:28<00:00,  9.65it/s, loss=0.0758]
Total time:  748s, loss: 0.0730
--------------------------------------------------
Epoch:   24,
Epoch 24: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5456/5456 [12:24<00:00,  7.33it/s, loss=0.0733]Total time:  744s, loss: 0.0714
--------------------------------------------------
Epoch:   25,
Epoch 25: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5456/5456 [12:23<00:00,  7.34it/s, loss=0.0763]Total time:  743s, loss: 0.0699
--------------------------------------------------
Epoch:   26,
Epoch 26:  76%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                            | 5456/7218 [12:21<03:59,  7.36it/s, loss=0.0766]Training time:  741s
Epoch 26: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎| 7198/7218 [12:25<00:02,  9.65it/s, loss=0.0766]Ellipsisng:  98%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍    | 1731/1762 [00:04<00:00, 499.09it/s]
Validation time:    4s
Epoch 26: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7218/7218 [12:26<00:00,  9.67it/s, loss=0.0766]
Total time:  746s, loss: 0.0685
--------------------------------------------------
Epoch:   27,
Epoch 27: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5456/5456 [12:23<00:00,  7.34it/s, loss=0.074]Total time:  743s, loss: 0.0672
--------------------------------------------------
Epoch:   28,
Epoch 28: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5456/5456 [12:20<00:00,  7.37it/s, loss=0.0699]Total time:  740s, loss: 0.0661
--------------------------------------------------
Epoch:   29,
Epoch 29:  76%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                            | 5456/7218 [12:28<04:01,  7.29it/s, loss=0.0683]Training time:  748s
Epoch 29: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋| 7209/7218 [12:33<00:00,  9.57it/s, loss=0.0683]
Ellipsisng: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎| 1757/1762 [00:04<00:00, 497.27it/s]
Validation time:    4s
Epoch 29: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7218/7218 [12:33<00:00,  9.58it/s, loss=0.0683]
Total time:  753s, loss: 0.0648
--------------------------------------------------
Epoch:   30,
Epoch 30: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5456/5456 [12:24<00:00,  7.33it/s, loss=0.0674]Total time:  744s, loss: 0.0638
--------------------------------------------------
Epoch:   31,
Epoch 31: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5456/5456 [12:25<00:00,  7.32it/s, loss=0.0632]Total time:  745s, loss: 0.0627
--------------------------------------------------
Epoch:   32,
Epoch 32:  76%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                            | 5456/7218 [12:25<04:00,  7.32it/s, loss=0.0634]Training time:  745s
Epoch 32: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7218/7218 [1:02:31<00:00,  1.92it/s, loss=0.0634]
                   mrr           mr   hit@1   hit@3  hit@10███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1762/1762 [50:06<00:00,  1.43s/it]
tail ranking  0.501382  1873.397529  41.34%  55.60%  67.35%
head ranking  0.182477  4799.290726  13.48%  20.58%  27.74%
mean ranking  0.341929  3336.344127  27.41%  38.09%  47.54%
Ellipsis
Validation time: 3006s
Epoch 32: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7218/7218 [1:02:32<00:00,  1.92it/s, loss=0.0634]
Total time: 3789s, loss: 0.0618
--------------------------------------------------
Epoch:   33,
Epoch 33: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5456/5456 [12:24<00:00,  7.32it/s, loss=0.0635]Total time:  744s, loss: 0.0609
--------------------------------------------------
Epoch:   34,
Epoch 34: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5456/5456 [12:24<00:00,  7.33it/s, loss=0.057]Total time:  744s, loss: 0.0600
--------------------------------------------------
Epoch:   35,
Epoch 35:  76%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                            | 5456/7218 [12:18<03:58,  7.39it/s, loss=0.0686]Training time:  738s
Epoch 35: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7218/7218 [1:02:34<00:00,  1.92it/s, loss=0.0686]
                   mrr           mr   hit@1   hit@3  hit@10███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1762/1762 [50:16<00:00,  1.44s/it]
tail ranking  0.505049  1845.399801  41.95%  55.67%  67.15%
head ranking  0.186065  4741.460446  13.78%  20.78%  28.32%
mean ranking  0.345557  3293.430124  27.87%  38.23%  47.73%
Ellipsis
Validation time: 3016s
Epoch 35: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7218/7218 [1:02:51<00:00,  1.91it/s, loss=0.0686]Total time: 3795s, loss: 0.0593
--------------------------------------------------
Epoch:   36,
Epoch 36: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5456/5456 [12:27<00:00,  7.30it/s, loss=0.0575]Total time:  747s, loss: 0.0583
--------------------------------------------------
Epoch:   37,
Epoch 37: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5456/5456 [12:26<00:00,  7.31it/s, loss=0.0641]Total time:  746s, loss: 0.0576
--------------------------------------------------
Epoch:   38,
Epoch 38:  76%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                            | 5456/7218 [12:24<04:00,  7.33it/s, loss=0.0568]Training time:  744s
Epoch 38: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7218/7218 [1:02:45<00:00,  1.92it/s, loss=0.0568]
                   mrr           mr   hit@1   hit@3  hit@10███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1762/1762 [50:21<00:00,  1.43s/it]
tail ranking  0.508117  1912.251101  42.39%  56.04%  67.09%
head ranking  0.181621  4786.065190  13.54%  20.08%  27.95%
mean ranking  0.344869  3349.158145  27.96%  38.06%  47.52%
Ellipsis
Validation time: 3021s
Epoch 38: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7218/7218 [1:02:46<00:00,  1.92it/s, loss=0.0568]
Total time: 3766s, loss: 0.0569
--------------------------------------------------
Epoch:   39,
Epoch 39: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5456/5456 [12:21<00:00,  7.36it/s, loss=0.0587]Total time:  741s, loss: 0.0562
--------------------------------------------------
Epoch:   40,
Epoch 40: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5456/5456 [12:21<00:00,  7.36it/s, loss=0.0609]Total time:  741s, loss: 0.0556
--------------------------------------------------
Epoch:   41,
Epoch 41:  76%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                            | 5456/7218 [12:23<04:00,  7.34it/s, loss=0.0556]Training time:  743s
Epoch 41: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7218/7218 [1:02:27<00:00,  1.93it/s, loss=0.0556]
                   mrr           mr   hit@1   hit@3  hit@10███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1762/1762 [50:04<00:00,  1.42s/it]
tail ranking  0.505028  1930.697628  42.08%  55.55%  66.77%
head ranking  0.179687  4785.987928  13.39%  19.71%  27.89%
mean ranking  0.342357  3358.342778  27.74%  37.63%  47.33%
Ellipsis
Validation time: 3004s
Epoch 41: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7218/7218 [1:02:27<00:00,  1.93it/s, loss=0.0556]
Total time: 3747s, loss: 0.0551
--------------------------------------------------
Epoch:   42,
Epoch 42: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5456/5456 [12:27<00:00,  7.29it/s, loss=0.0557]Total time:  747s, loss: 0.0544
--------------------------------------------------
Epoch:   43,
Epoch 43: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5456/5456 [12:26<00:00,  7.31it/s, loss=0.0553]Total time:  746s, loss: 0.0538
--------------------------------------------------
Epoch:   44,
Epoch 44:  76%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                            | 5456/7218 [12:26<04:01,  7.31it/s, loss=0.0528]Training time:  746s
Epoch 44: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7218/7218 [1:02:54<00:00,  1.91it/s, loss=0.0528]
                   mrr           mr   hit@1   hit@3  hit@10███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1762/1762 [50:28<00:00,  1.45s/it]
tail ranking  0.501123  1952.323108  41.39%  55.65%  66.64%
head ranking  0.178928  4732.984519  13.05%  20.15%  27.94%
mean ranking  0.340025  3342.653813  27.22%  37.90%  47.29%
Ellipsis
Validation time: 3028s
Epoch 44: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7218/7218 [1:02:55<00:00,  1.91it/s, loss=0.0528]
Total time: 3775s, loss: 0.0533
--------------------------------------------------
Epoch:   45,
Epoch 45: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5456/5456 [12:27<00:00,  7.30it/s, loss=0.0536]Total time:  747s, loss: 0.0528
--------------------------------------------------
Epoch:   46,
Epoch 46: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5456/5456 [12:25<00:00,  7.32it/s, loss=0.0548]Total time:  745s, loss: 0.0523
--------------------------------------------------
Epoch:   47,
Epoch 47:  76%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                            | 5456/7218 [12:23<04:00,  7.34it/s, loss=0.054]Training time:  743s
Epoch 47: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7218/7218 [1:02:50<00:00,  1.91it/s, loss=0.054]
                   mrr           mr   hit@1   hit@3  hit@10███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 1762/1762 [50:27<00:00,  1.44s/it]
tail ranking  0.500634  1943.915069  41.32%  55.56%  66.84%
head ranking  0.181886  4776.362591  13.52%  20.51%  27.65%
mean ranking  0.341260  3360.138830  27.42%  38.03%  47.24%
Ellipsis
Validation time: 3027s
Epoch 47: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 7218/7218 [1:02:50<00:00,  1.91it/s, loss=0.054]
Total time: 3770s, loss: 0.0518
--------------------------------------------------
Epoch:   48,
Epoch 48: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5456/5456 [12:25<00:00,  7.32it/s, loss=0.051]Total time:  745s, loss: 0.0514
--------------------------------------------------
Epoch:   49,
Epoch 49: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5456/5456 [12:24<00:00,  7.33it/s, loss=0.0528]Total time:  744s, loss: 0.0510
--------------------------------------------------
Epoch 49: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5456/5456 [12:24<00:00,  7.33it/s, loss=0.0528]
model_path: /raid/chrisjihee/proj/KG-S2S/checkpoint/FB15k-237N-2023-12-01 00:47:25.667747/FB15k-237N-epoch=035-val_mrr=0.3456.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3,4,5,6,7]
Testing: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2058/2058 [59:02<00:00,  1.52s/it]                   mrr           mr   hit@1   hit@3  hit@10
tail ranking  0.503533  2013.799538  42.09%  55.53%  65.88%
head ranking  0.190591  4671.955628  14.27%  20.99%  29.29%
mean ranking  0.347062  3342.877583  28.18%  38.26%  47.58%
--------------------------------------------------------------------------------
DATALOADER:0 TEST RESULTS
{'val_mrr': 0.34706196188926697}
--------------------------------------------------------------------------------
DATALOADER:1 TEST RESULTS
{'val_mrr': 0.34706196188926697}
--------------------------------------------------------------------------------

==================================================
Epoch: test
Ellipsis
==================================================
Testing: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2058/2058 [59:02<00:00,  1.72s/it]
(KG-S2S) chrisjihee@dgx-a100:~/proj/KG-S2S$

