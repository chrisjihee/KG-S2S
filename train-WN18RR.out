(KG-S2S) chrisjihee@dgx-a100:~/proj/KG-S2S$ bash train-WN18RR.sh
Namespace(batch_size=64, dataset='WN18RR', dataset_path='./data/processed', decoder='beam_search', diversity_penalty=0.0, epochs=100, eval_tgt_max_length=30, gpu='0', log_text=False, lr=0.001, model='T5Finetuner', model_dim=768, model_path='', n_ent=40943, n_rel=11, num_beam_groups=1, num_beams=40, num_workers=4, optim='Adam', pretrained_model='t5-base', save_dir='./checkpoint/WN18RR-2023-12-01 00:47:11.505860', seed=41504, seq_dropout=0.1, skip_n_val_epoch=30, src_descrip_max_length=40, src_max_length=512, temporal=False, tgt_descrip_max_length=10, train_tgt_max_length=512, use_prefix_search=False, use_rel_prompt_emb=True, use_soft_prompt=True, val_batch_size=8, vocab_size=32128)
Global seed set to 41504
tokenizing entities...
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 40943/40943 [01:44<00:00, 390.50it/s]
datamodule construction done.
GPU available: True, used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
model construction done.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3,4,5,6,7]

  | Name                       | Type                               | Params
----------------------------------------------------------------------------------
0 | T5ForConditionalGeneration | ModifiedT5ForConditionalGeneration | 222 M
1 | rel_embed1                 | Embedding                          | 8.4 K
2 | rel_embed2                 | Embedding                          | 8.4 K
3 | rel_embed3                 | Embedding                          | 8.4 K
4 | rel_embed4                 | Embedding                          | 8.4 K
----------------------------------------------------------------------------------
222 M     Trainable params
0         Non-trainable params
222 M     Total params
891.749   Total estimated model params size (MB)
Training: 0it [00:00, ?it/s]Epoch:    0,
Epoch 0: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:56<00:00,  7.60it/s, loss=0.713]Total time:  356s, loss: 0.9069
--------------------------------------------------
Epoch:    1,
Epoch 1: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:50<00:00,  7.74it/s, loss=0.55]Total time:  350s, loss: 0.6024
--------------------------------------------------
Epoch:    2,
Epoch 2:  78%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                      | 2714/3474 [05:53<01:38,  7.69it/s, loss=0.463]Training time:  353s
Epoch 2: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊ | 3458/3474 [05:55<00:01,  9.71it/s, loss=0.463]Ellipsisng:  96%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏         | 731/760 [00:02<00:00, 429.98it/s]
Validation time:    3s
Epoch 2: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3474/3474 [05:56<00:00,  9.75it/s, loss=0.463]
Total time:  356s, loss: 0.4692
--------------------------------------------------
Epoch:    3,
Epoch 3: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:53<00:00,  7.67it/s, loss=0.382]Total time:  353s, loss: 0.3892
--------------------------------------------------
Epoch:    4,
Epoch 4: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:50<00:00,  7.75it/s, loss=0.331]Total time:  350s, loss: 0.3347
--------------------------------------------------
Epoch:    5,
Epoch 5:  78%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                      | 2714/3474 [05:48<01:37,  7.78it/s, loss=0.296]Training time:  348s
Epoch 5:  99%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎   | 3422/3474 [05:51<00:05,  9.74it/s, loss=0.296]
Ellipsisng:  98%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉    | 748/760 [00:02<00:00, 449.23it/s]
Validation time:    2s
Epoch 5: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3474/3474 [05:51<00:00,  9.88it/s, loss=0.296]
Total time:  351s, loss: 0.2944
--------------------------------------------------
Epoch:    6,
Epoch 6: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:55<00:00,  7.63it/s, loss=0.26]Total time:  355s, loss: 0.2636
--------------------------------------------------
Epoch:    7,
Epoch 7: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:53<00:00,  7.68it/s, loss=0.246]Total time:  353s, loss: 0.2388
--------------------------------------------------
Epoch:    8,
Epoch 8:  78%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                      | 2714/3474 [05:51<01:38,  7.72it/s, loss=0.215]Training time:  351s
Epoch 8:  99%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎   | 3422/3474 [05:54<00:05,  9.66it/s, loss=0.215]
Ellipsisng: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 760/760 [00:02<00:00, 276.83it/s]
Validation time:    2s
Epoch 8: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3474/3474 [05:54<00:00,  9.79it/s, loss=0.215]
Total time:  354s, loss: 0.2189
--------------------------------------------------
Epoch:    9,
Epoch 9: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:54<00:00,  7.66it/s, loss=0.208]Total time:  354s, loss: 0.2011
--------------------------------------------------
Epoch:   10,
Epoch 10: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:53<00:00,  7.68it/s, loss=0.205]Total time:  353s, loss: 0.1872
--------------------------------------------------
Epoch:   11,
Epoch 11:  78%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                      | 2714/3474 [05:52<01:38,  7.70it/s, loss=0.176]Training time:  352s
Epoch 11:  99%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎   | 3422/3474 [05:54<00:05,  9.64it/s, loss=0.176]
Ellipsisng: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 760/760 [00:02<00:00, 277.52it/s]
Validation time:    2s
Epoch 11: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3474/3474 [05:55<00:00,  9.78it/s, loss=0.176]
Total time:  355s, loss: 0.1747
--------------------------------------------------
Epoch:   12,
Epoch 12: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:52<00:00,  7.70it/s, loss=0.176]Total time:  352s, loss: 0.1648
--------------------------------------------------
Epoch:   13,
Epoch 13: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:54<00:00,  7.65it/s, loss=0.167]Total time:  354s, loss: 0.1556
--------------------------------------------------
Epoch:   14,
Epoch 14:  78%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                      | 2714/3474 [05:53<01:38,  7.68it/s, loss=0.15]Training time:  353s
Epoch 14:  99%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎   | 3422/3474 [05:55<00:05,  9.61it/s, loss=0.15]
Ellipsisng:  98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉     | 745/760 [00:02<00:00, 412.91it/s]
Validation time:    2s
Epoch 14: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3474/3474 [05:56<00:00,  9.75it/s, loss=0.15]
Total time:  356s, loss: 0.1484
--------------------------------------------------
Epoch:   15,
Epoch 15: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:55<00:00,  7.64it/s, loss=0.15]Total time:  355s, loss: 0.1406
--------------------------------------------------
Epoch:   16,
Epoch 16: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:53<00:00,  7.67it/s, loss=0.143]Total time:  353s, loss: 0.1348
--------------------------------------------------
Epoch:   17,
Epoch 17:  78%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                      | 2714/3474 [05:49<01:37,  7.78it/s, loss=0.134]Training time:  349s
Epoch 17:  99%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎   | 3422/3474 [05:51<00:05,  9.73it/s, loss=0.134]
Ellipsisng:  99%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎  | 752/760 [00:02<00:00, 431.45it/s]
Validation time:    2s
Epoch 17: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3474/3474 [05:51<00:00,  9.87it/s, loss=0.134]
Total time:  351s, loss: 0.1298
--------------------------------------------------
Epoch:   18,
Epoch 18: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:53<00:00,  7.67it/s, loss=0.131]Total time:  353s, loss: 0.1250
--------------------------------------------------
Epoch:   19,
Epoch 19: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:51<00:00,  7.73it/s, loss=0.133]Total time:  351s, loss: 0.1207
--------------------------------------------------
Epoch:   20,
Epoch 20:  78%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                      | 2714/3474 [05:52<01:38,  7.71it/s, loss=0.116]Training time:  352s
Epoch 20:  99%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎   | 3422/3474 [05:54<00:05,  9.64it/s, loss=0.116]
Ellipsisng:  95%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 719/760 [00:02<00:00, 391.93it/s]
Validation time:    2s
Epoch 20: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3474/3474 [05:55<00:00,  9.78it/s, loss=0.116]
Total time:  355s, loss: 0.1166
--------------------------------------------------
Epoch:   21,
Epoch 21: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:53<00:00,  7.68it/s, loss=0.123]Total time:  353s, loss: 0.1136
--------------------------------------------------
Epoch:   22,
Epoch 22: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:51<00:00,  7.72it/s, loss=0.112]Total time:  351s, loss: 0.1103
--------------------------------------------------
Epoch:   23,
Epoch 23:  78%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                      | 2714/3474 [05:50<01:38,  7.74it/s, loss=0.112]Training time:  350s
Epoch 23:  99%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎   | 3422/3474 [05:53<00:05,  9.68it/s, loss=0.112]
Ellipsisng:  98%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉      | 742/760 [00:02<00:00, 424.26it/s]
Validation time:    2s
Epoch 23: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3474/3474 [05:53<00:00,  9.82it/s, loss=0.112]
Total time:  353s, loss: 0.1075
--------------------------------------------------
Epoch:   24,
Epoch 24: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:52<00:00,  7.70it/s, loss=0.109]Total time:  352s, loss: 0.1048
--------------------------------------------------
Epoch:   25,
Epoch 25: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:52<00:00,  7.70it/s, loss=0.113]Total time:  352s, loss: 0.1019
--------------------------------------------------
Epoch:   26,
Epoch 26:  78%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                      | 2714/3474 [05:52<01:38,  7.69it/s, loss=0.104]Training time:  352s
Epoch 26:  99%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎   | 3422/3474 [05:55<00:05,  9.63it/s, loss=0.104]
Ellipsisng:  94%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍               | 714/760 [00:02<00:00, 416.78it/s]
Validation time:    2s
Epoch 26: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3474/3474 [05:55<00:00,  9.77it/s, loss=0.104]
Total time:  355s, loss: 0.1000
--------------------------------------------------
Epoch:   27,
Epoch 27: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:54<00:00,  7.66it/s, loss=0.0994]Total time:  354s, loss: 0.0976
--------------------------------------------------
Epoch:   28,
Epoch 28: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:53<00:00,  7.68it/s, loss=0.0981]Total time:  353s, loss: 0.0962
--------------------------------------------------
Epoch:   29,
Epoch 29:  78%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                     | 2714/3474 [05:52<01:38,  7.71it/s, loss=0.0996]Training time:  352s
Epoch 29:  99%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎   | 3422/3474 [05:54<00:05,  9.65it/s, loss=0.0996]
Ellipsisng: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 760/760 [00:02<00:00, 271.32it/s]
Validation time:    2s
Epoch 29: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3474/3474 [05:55<00:00,  9.78it/s, loss=0.0996]
Total time:  355s, loss: 0.0943
--------------------------------------------------
Epoch:   30,
Epoch 30: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:51<00:00,  7.72it/s, loss=0.0944]Total time:  351s, loss: 0.0925
--------------------------------------------------
Epoch:   31,
Epoch 31: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:49<00:00,  7.78it/s, loss=0.099]Total time:  349s, loss: 0.0911
--------------------------------------------------
Epoch:   32,
Epoch 32:  78%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                     | 2714/3474 [05:50<01:38,  7.74it/s, loss=0.0944]Training time:  350s
Epoch 32: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3474/3474 [26:55<00:00,  2.15it/s, loss=0.0944]
                   mrr           mr   hit@1   hit@3  hit@10█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 760/760 [21:05<00:00,  1.43s/it]
tail ranking  0.638580  3981.750824  56.79%  69.08%  76.30%
head ranking  0.473808  8644.764997  42.95%  50.46%  55.21%
mean ranking  0.556194  6313.257910  49.87%  59.77%  65.75%
Ellipsis
Validation time: 1265s
Epoch 32: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3474/3474 [26:55<00:00,  2.15it/s, loss=0.0944]
Total time: 1650s, loss: 0.0894
--------------------------------------------------
Epoch:   33,
Epoch 33: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:55<00:00,  7.63it/s, loss=0.0916]Total time:  355s, loss: 0.0884
--------------------------------------------------
Epoch:   34,
Epoch 34: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:52<00:00,  7.69it/s, loss=0.0957]Total time:  352s, loss: 0.0867
--------------------------------------------------
Epoch:   35,
Epoch 35:  78%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                      | 2714/3474 [05:55<01:39,  7.63it/s, loss=0.093]Training time:  355s
Epoch 35: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3474/3474 [26:57<00:00,  2.15it/s, loss=0.093]
                   mrr           mr   hit@1   hit@3  hit@10█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 760/760 [21:02<00:00,  1.43s/it]
tail ranking  0.645520  3703.061635  57.68%  69.61%  76.96%
head ranking  0.477101  8173.808504  43.51%  50.26%  55.37%
mean ranking  0.561311  5938.435069  50.59%  59.94%  66.17%
Ellipsis
Validation time: 1262s
Epoch 35: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3474/3474 [27:13<00:00,  2.13it/s, loss=0.093]Total time: 1652s, loss: 0.0857
--------------------------------------------------
Epoch:   36,
Epoch 36: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:53<00:00,  7.68it/s, loss=0.0915]Total time:  353s, loss: 0.0846
--------------------------------------------------
Epoch:   37,
Epoch 37: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:54<00:00,  7.65it/s, loss=0.0894]Total time:  354s, loss: 0.0835
--------------------------------------------------
Epoch:   38,
Epoch 38:  78%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                      | 2714/3474 [05:53<01:39,  7.68it/s, loss=0.092]Training time:  353s
Epoch 38: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3474/3474 [26:52<00:00,  2.15it/s, loss=0.092]
                   mrr           mr   hit@1   hit@3  hit@10█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 760/760 [21:00<00:00,  1.45s/it]
tail ranking  0.646109  3850.442320  58.01%  69.28%  76.63%
head ranking  0.474956  8335.129862  43.08%  50.33%  55.57%
mean ranking  0.560533  6092.786091  50.54%  59.81%  66.10%
Ellipsis
Validation time: 1260s
Epoch 38: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3474/3474 [26:53<00:00,  2.15it/s, loss=0.092]
Total time: 1613s, loss: 0.0826
--------------------------------------------------
Epoch:   39,
Epoch 39: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:53<00:00,  7.67it/s, loss=0.0891]Total time:  353s, loss: 0.0818
--------------------------------------------------
Epoch:   40,
Epoch 40: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:54<00:00,  7.66it/s, loss=0.0895]Total time:  354s, loss: 0.0808
--------------------------------------------------
Epoch:   41,
Epoch 41:  78%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                     | 2714/3474 [05:54<01:39,  7.65it/s, loss=0.0826]Training time:  354s
Epoch 41: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3474/3474 [26:57<00:00,  2.15it/s, loss=0.0826]
                   mrr           mr   hit@1   hit@3  hit@10█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 760/760 [21:03<00:00,  1.45s/it]
tail ranking  0.646731  3824.699407  58.11%  69.48%  76.86%
head ranking  0.479216  8422.072182  43.77%  50.66%  55.54%
mean ranking  0.562974  6123.385794  50.94%  60.07%  66.20%
Ellipsis
Validation time: 1263s
Epoch 41: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3474/3474 [27:12<00:00,  2.13it/s, loss=0.0826]Total time: 1651s, loss: 0.0794
--------------------------------------------------
Epoch:   42,
Epoch 42: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:59<00:00,  7.56it/s, loss=0.0867]Total time:  359s, loss: 0.0790
--------------------------------------------------
Epoch:   43,
Epoch 43: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:55<00:00,  7.64it/s, loss=0.0838]Total time:  355s, loss: 0.0779
--------------------------------------------------
Epoch:   44,
Epoch 44:  78%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                     | 2714/3474 [05:55<01:39,  7.63it/s, loss=0.0909]Training time:  355s
Epoch 44: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3474/3474 [27:08<00:00,  2.13it/s, loss=0.0909]
                   mrr           mr   hit@1   hit@3  hit@10█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 760/760 [21:13<00:00,  1.46s/it]
tail ranking  0.648159  3994.872446  58.17%  69.38%  77.16%
head ranking  0.479175  8467.914634  43.84%  50.69%  55.24%
mean ranking  0.563667  6231.393540  51.01%  60.04%  66.20%
Ellipsis
Validation time: 1273s
Epoch 44: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3474/3474 [27:18<00:00,  2.12it/s, loss=0.0909]Total time: 1662s, loss: 0.0775
--------------------------------------------------
Epoch:   45,
Epoch 45: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:54<00:00,  7.66it/s, loss=0.0859]Total time:  354s, loss: 0.0767
--------------------------------------------------
Epoch:   46,
Epoch 46: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:55<00:00,  7.64it/s, loss=0.0774]Total time:  355s, loss: 0.0759
--------------------------------------------------
Epoch:   47,
Epoch 47:  78%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                     | 2714/3474 [05:56<01:39,  7.61it/s, loss=0.0793]Training time:  356s
Epoch 47: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3474/3474 [27:11<00:00,  2.13it/s, loss=0.0793]
                   mrr           mr   hit@1   hit@3  hit@10█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 760/760 [21:15<00:00,  1.45s/it]
tail ranking  0.651806  3872.012854  58.80%  69.48%  77.19%
head ranking  0.481820  8413.134476  44.36%  50.46%  55.24%
mean ranking  0.566813  6142.573665  51.58%  59.97%  66.22%
Ellipsis
Validation time: 1275s
Epoch 47: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3474/3474 [27:26<00:00,  2.11it/s, loss=0.0793]Total time: 1664s, loss: 0.0753
--------------------------------------------------
Epoch:   48,
Epoch 48: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:55<00:00,  7.63it/s, loss=0.0804]Total time:  355s, loss: 0.0747
--------------------------------------------------
Epoch:   49,
Epoch 49: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:52<00:00,  7.70it/s, loss=0.0801]Total time:  352s, loss: 0.0746
--------------------------------------------------
Epoch:   50,
Epoch 50:  78%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                     | 2714/3474 [05:52<01:38,  7.69it/s, loss=0.0772]Training time:  352s
Epoch 50: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3474/3474 [26:54<00:00,  2.15it/s, loss=0.0772]
                   mrr           mr   hit@1   hit@3  hit@10█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 760/760 [21:02<00:00,  1.45s/it]
tail ranking  0.647030  3963.051088  58.40%  68.33%  76.86%
head ranking  0.483598  8697.412657  44.83%  50.30%  55.47%
mean ranking  0.565314  6330.231872  51.62%  59.31%  66.17%
Ellipsis
Validation time: 1262s
Epoch 50: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3474/3474 [26:55<00:00,  2.15it/s, loss=0.0772]
Total time: 1615s, loss: 0.0731
--------------------------------------------------
Epoch:   51,
Epoch 51: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:52<00:00,  7.69it/s, loss=0.0737]Total time:  352s, loss: 0.0729
--------------------------------------------------
Epoch:   52,
Epoch 52: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:51<00:00,  7.71it/s, loss=0.078]Total time:  351s, loss: 0.0725
--------------------------------------------------
Epoch:   53,
Epoch 53:  78%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                     | 2714/3474 [05:51<01:38,  7.72it/s, loss=0.0785]Training time:  351s
Epoch 53: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3474/3474 [27:05<00:00,  2.14it/s, loss=0.0785]
                   mrr           mr   hit@1   hit@3  hit@10█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 760/760 [21:15<00:00,  1.44s/it]
tail ranking  0.647175  3928.906394  58.14%  68.85%  77.19%
head ranking  0.484170  8454.674357  44.83%  50.63%  55.60%
mean ranking  0.565672  6191.790376  51.48%  59.74%  66.40%
Ellipsis
Validation time: 1275s
Epoch 53: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3474/3474 [27:06<00:00,  2.14it/s, loss=0.0785]
Total time: 1626s, loss: 0.0720
--------------------------------------------------
Epoch:   54,
Epoch 54: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:50<00:00,  7.75it/s, loss=0.0729]Total time:  350s, loss: 0.0713
--------------------------------------------------
Epoch:   55,
Epoch 55: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:54<00:00,  7.66it/s, loss=0.0752]Total time:  354s, loss: 0.0707
--------------------------------------------------
Epoch:   56,
Epoch 56:  78%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                     | 2714/3474 [05:55<01:39,  7.63it/s, loss=0.0712]Training time:  355s
Epoch 56: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3474/3474 [27:02<00:00,  2.14it/s, loss=0.0712]
                   mrr           mr   hit@1   hit@3  hit@10█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 760/760 [21:07<00:00,  1.46s/it]
tail ranking  0.650195  4210.000659  58.64%  69.31%  76.66%
head ranking  0.483548  8463.572512  44.83%  50.20%  55.47%
mean ranking  0.566871  6336.786585  51.73%  59.76%  66.07%
Ellipsis
Validation time: 1267s
Epoch 56: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3474/3474 [27:12<00:00,  2.13it/s, loss=0.0712]Total time: 1656s, loss: 0.0705
--------------------------------------------------
Epoch:   57,
Epoch 57: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:56<00:00,  7.61it/s, loss=0.0736]Total time:  356s, loss: 0.0701
--------------------------------------------------
Epoch:   58,
Epoch 58: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:52<00:00,  7.69it/s, loss=0.0748]Total time:  352s, loss: 0.0696
--------------------------------------------------
Epoch:   59,
Epoch 59:  78%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                     | 2714/3474 [05:50<01:38,  7.75it/s, loss=0.0703]Training time:  350s
Epoch 59: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3474/3474 [26:54<00:00,  2.15it/s, loss=0.0703]
                   mrr           mr   hit@1   hit@3  hit@10█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 760/760 [21:05<00:00,  1.44s/it]
tail ranking  0.644983  4192.759394  58.50%  68.09%  75.77%
head ranking  0.483450  8238.529005  44.53%  50.59%  55.57%
mean ranking  0.564216  6215.644199  51.52%  59.34%  65.67%
Ellipsis
Validation time: 1265s
Epoch 59: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3474/3474 [26:55<00:00,  2.15it/s, loss=0.0703]
Total time: 1615s, loss: 0.0689
--------------------------------------------------
Epoch:   60,
Epoch 60: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:53<00:00,  7.69it/s, loss=0.0741]Total time:  353s, loss: 0.0685
--------------------------------------------------
Epoch:   61,
Epoch 61: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:53<00:00,  7.68it/s, loss=0.0685]Total time:  353s, loss: 0.0682
--------------------------------------------------
Epoch:   62,
Epoch 62:  78%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                     | 2714/3474 [05:53<01:38,  7.68it/s, loss=0.0781]Training time:  353s
Epoch 62: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3474/3474 [26:55<00:00,  2.15it/s, loss=0.0781]
                   mrr           mr   hit@1   hit@3  hit@10█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 760/760 [21:03<00:00,  1.48s/it]
tail ranking  0.651738  3730.934080  58.77%  69.35%  76.60%
head ranking  0.483020  8268.521753  44.76%  49.97%  55.17%
mean ranking  0.567379  5999.727917  51.76%  59.66%  65.89%
Ellipsis
Validation time: 1263s
Epoch 62: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3474/3474 [27:16<00:00,  2.12it/s, loss=0.0781]Total time: 1649s, loss: 0.0679
--------------------------------------------------
Epoch:   63,
Epoch 63: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:56<00:00,  7.62it/s, loss=0.073]Total time:  356s, loss: 0.0674
--------------------------------------------------
Epoch:   64,
Epoch 64: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:52<00:00,  7.70it/s, loss=0.0717]Total time:  352s, loss: 0.0669
--------------------------------------------------
Epoch:   65,
Epoch 65:  78%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                     | 2714/3474 [05:52<01:38,  7.70it/s, loss=0.0706]Training time:  352s
Epoch 65: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3474/3474 [26:57<00:00,  2.15it/s, loss=0.0706]
                   mrr           mr   hit@1   hit@3  hit@10█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 760/760 [21:06<00:00,  1.46s/it]
tail ranking  0.653431  3850.807185  59.03%  69.38%  77.06%
head ranking  0.487078  8235.069545  45.32%  50.53%  55.24%
mean ranking  0.570255  6042.938365  52.18%  59.95%  66.15%
Ellipsis
Validation time: 1266s
Epoch 65: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3474/3474 [27:13<00:00,  2.13it/s, loss=0.0706]Total time: 1650s, loss: 0.0669
--------------------------------------------------
Epoch:   66,
Epoch 66: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:53<00:00,  7.68it/s, loss=0.0681]Total time:  353s, loss: 0.0664
--------------------------------------------------
Epoch:   67,
Epoch 67: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:52<00:00,  7.69it/s, loss=0.0712]Total time:  352s, loss: 0.0660
--------------------------------------------------
Epoch:   68,
Epoch 68:  78%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                     | 2714/3474 [05:53<01:38,  7.68it/s, loss=0.0697]Training time:  353s
Epoch 68: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3474/3474 [26:54<00:00,  2.15it/s, loss=0.0697]
                   mrr           mr   hit@1   hit@3  hit@10█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 760/760 [21:02<00:00,  1.45s/it]
tail ranking  0.652057  4126.341134  59.13%  69.45%  76.60%
head ranking  0.481814  8511.878708  44.66%  50.10%  55.11%
mean ranking  0.566935  6319.109921  51.90%  59.77%  65.85%
Ellipsis
Validation time: 1262s
Epoch 68: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3474/3474 [26:55<00:00,  2.15it/s, loss=0.0697]
Total time: 1615s, loss: 0.0657
--------------------------------------------------
Epoch:   69,
Epoch 69: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:53<00:00,  7.68it/s, loss=0.0676]Total time:  353s, loss: 0.0654
--------------------------------------------------
Epoch:   70,
Epoch 70: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:53<00:00,  7.68it/s, loss=0.0709]Total time:  353s, loss: 0.0652
--------------------------------------------------
Epoch:   71,
Epoch 71:  78%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                     | 2714/3474 [05:53<01:38,  7.68it/s, loss=0.0714]Training time:  353s
Epoch 71: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3474/3474 [26:56<00:00,  2.15it/s, loss=0.0714]
                   mrr           mr   hit@1   hit@3  hit@10█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 760/760 [21:03<00:00,  1.48s/it]
tail ranking  0.651631  3929.600857  59.13%  69.05%  76.43%
head ranking  0.484124  8460.117666  45.02%  50.20%  54.81%
mean ranking  0.567877  6194.859262  52.08%  59.62%  65.62%
Ellipsis
Validation time: 1263s
Epoch 71: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3474/3474 [26:57<00:00,  2.15it/s, loss=0.0714]
Total time: 1617s, loss: 0.0647
--------------------------------------------------
Epoch:   72,
Epoch 72: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:52<00:00,  7.70it/s, loss=0.0667]Total time:  352s, loss: 0.0644
--------------------------------------------------
Epoch:   73,
Epoch 73: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:53<00:00,  7.68it/s, loss=0.0709]Total time:  353s, loss: 0.0641
--------------------------------------------------
Epoch:   74,
Epoch 74:  78%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                     | 2714/3474 [05:49<01:37,  7.76it/s, loss=0.0667]Training time:  349s
Epoch 74: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3474/3474 [26:51<00:00,  2.16it/s, loss=0.0667]
                   mrr           mr   hit@1   hit@3  hit@10█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 760/760 [21:02<00:00,  1.44s/it]
tail ranking  0.660265  4031.472643  60.71%  69.55%  75.77%
head ranking  0.485835  8615.218194  45.45%  49.87%  55.04%
mean ranking  0.573050  6323.345419  53.08%  59.71%  65.41%
Ellipsis
Validation time: 1262s
Epoch 74: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3474/3474 [27:01<00:00,  2.14it/s, loss=0.0667]Total time: 1646s, loss: 0.0639
--------------------------------------------------
Epoch:   75,
Epoch 75: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:57<00:00,  7.59it/s, loss=0.066]Total time:  357s, loss: 0.0635
--------------------------------------------------
Epoch:   76,
Epoch 76: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:56<00:00,  7.62it/s, loss=0.0681]Total time:  356s, loss: 0.0634
--------------------------------------------------
Epoch:   77,
Epoch 77:  78%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                     | 2714/3474 [05:52<01:38,  7.70it/s, loss=0.0668]Training time:  352s
Epoch 77: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3474/3474 [27:04<00:00,  2.14it/s, loss=0.0668]
                   mrr           mr   hit@1   hit@3  hit@10█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 760/760 [21:13<00:00,  1.46s/it]
tail ranking  0.655598  4116.949242  59.79%  69.25%  76.40%
head ranking  0.484215  8238.960778  44.89%  50.26%  55.54%
mean ranking  0.569906  6177.955010  52.34%  59.76%  65.97%
Ellipsis
Validation time: 1273s
Epoch 77: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3474/3474 [27:05<00:00,  2.14it/s, loss=0.0668]
Total time: 1625s, loss: 0.0630
--------------------------------------------------
Epoch:   78,
Epoch 78: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:54<00:00,  7.67it/s, loss=0.0705]Total time:  354s, loss: 0.0630
--------------------------------------------------
Epoch:   79,
Epoch 79: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:54<00:00,  7.66it/s, loss=0.0647]Total time:  354s, loss: 0.0624
--------------------------------------------------
Epoch:   80,
Epoch 80:  78%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                     | 2714/3474 [05:53<01:38,  7.69it/s, loss=0.0624]Training time:  353s
Epoch 80: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3474/3474 [27:11<00:00,  2.13it/s, loss=0.0624]
                   mrr           mr   hit@1   hit@3  hit@10█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 760/760 [21:19<00:00,  1.48s/it]
tail ranking  0.656455  3862.796309  60.02%  69.02%  76.57%
head ranking  0.487694  8592.925181  45.52%  50.30%  55.17%
mean ranking  0.572075  6227.860745  52.77%  59.66%  65.87%
Ellipsis
Validation time: 1279s
Epoch 80: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3474/3474 [27:12<00:00,  2.13it/s, loss=0.0624]
Total time: 1632s, loss: 0.0621
--------------------------------------------------
Epoch:   81,
Epoch 81: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:52<00:00,  7.69it/s, loss=0.0667]Total time:  352s, loss: 0.0621
--------------------------------------------------
Epoch:   82,
Epoch 82: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:52<00:00,  7.69it/s, loss=0.0657]Total time:  352s, loss: 0.0618
--------------------------------------------------
Epoch:   83,
Epoch 83:  78%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                     | 2714/3474 [05:54<01:39,  7.65it/s, loss=0.0655]Training time:  354s
Epoch 83: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3474/3474 [27:07<00:00,  2.13it/s, loss=0.0655]
                   mrr           mr   hit@1   hit@3  hit@10█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 760/760 [21:13<00:00,  1.46s/it]
tail ranking  0.650292  3946.136783  59.13%  68.98%  76.17%
head ranking  0.488184  8474.828609  45.52%  50.66%  55.31%
mean ranking  0.569238  6210.482696  52.32%  59.82%  65.74%
Ellipsis
Validation time: 1273s
Epoch 83: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3474/3474 [27:08<00:00,  2.13it/s, loss=0.0655]
Total time: 1628s, loss: 0.0617
--------------------------------------------------
Epoch:   84,
Epoch 84: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:55<00:00,  7.63it/s, loss=0.0661]Total time:  355s, loss: 0.0615
--------------------------------------------------
Epoch:   85,
Epoch 85: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:53<00:00,  7.67it/s, loss=0.0647]Total time:  353s, loss: 0.0612
--------------------------------------------------
Epoch:   86,
Epoch 86:  78%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                     | 2714/3474 [05:54<01:39,  7.66it/s, loss=0.0641]Training time:  354s
Epoch 86: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3474/3474 [27:07<00:00,  2.13it/s, loss=0.0641]
                   mrr           mr   hit@1   hit@3  hit@10█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 760/760 [21:14<00:00,  1.44s/it]
tail ranking  0.653859  4092.509888  59.69%  69.15%  76.27%
head ranking  0.488605  8577.800264  45.58%  50.86%  55.37%
mean ranking  0.571232  6335.155076  52.64%  60.00%  65.82%
Ellipsis
Validation time: 1274s
Epoch 86: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3474/3474 [27:08<00:00,  2.13it/s, loss=0.0641]
Total time: 1628s, loss: 0.0613
--------------------------------------------------
Epoch:   87,
Epoch 87: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:54<00:00,  7.66it/s, loss=0.0615]Total time:  354s, loss: 0.0603
--------------------------------------------------
Epoch:   88,
Epoch 88: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:53<00:00,  7.68it/s, loss=0.0647]Total time:  353s, loss: 0.0606
--------------------------------------------------
Epoch:   89,
Epoch 89:  78%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                     | 2714/3474 [05:54<01:39,  7.67it/s, loss=0.0622]Training time:  354s
Epoch 89: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3474/3474 [26:55<00:00,  2.15it/s, loss=0.0622]
                   mrr           mr   hit@1   hit@3  hit@10█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 760/760 [21:02<00:00,  1.46s/it]
tail ranking  0.652419  4007.697759  59.49%  69.08%  75.81%
head ranking  0.485808  8572.358273  45.52%  50.20%  54.91%
mean ranking  0.569114  6290.028016  52.50%  59.64%  65.36%
Ellipsis
Validation time: 1262s
Epoch 89: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3474/3474 [26:56<00:00,  2.15it/s, loss=0.0622]
Total time: 1616s, loss: 0.0606
--------------------------------------------------
Epoch:   90,
Epoch 90: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:48<00:00,  7.78it/s, loss=0.0648]Total time:  348s, loss: 0.0601
--------------------------------------------------
Epoch:   91,
Epoch 91: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:50<00:00,  7.75it/s, loss=0.0616]Total time:  350s, loss: 0.0598
--------------------------------------------------
Epoch:   92,
Epoch 92:  78%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                     | 2714/3474 [05:52<01:38,  7.71it/s, loss=0.0603]Training time:  352s
Epoch 92: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3474/3474 [26:53<00:00,  2.15it/s, loss=0.0603]
                   mrr           mr   hit@1   hit@3  hit@10█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 760/760 [21:02<00:00,  1.44s/it]
tail ranking  0.653904  4313.997034  59.69%  68.82%  76.40%
head ranking  0.487235  8590.440672  45.52%  50.63%  55.01%
mean ranking  0.570570  6452.218853  52.60%  59.72%  65.71%
Ellipsis
Validation time: 1262s
Epoch 92: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3474/3474 [26:54<00:00,  2.15it/s, loss=0.0603]
Total time: 1614s, loss: 0.0599
--------------------------------------------------
Epoch:   93,
Epoch 93: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:53<00:00,  7.67it/s, loss=0.0599]Total time:  353s, loss: 0.0597
--------------------------------------------------
Epoch:   94,
Epoch 94: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:53<00:00,  7.67it/s, loss=0.0631]Total time:  353s, loss: 0.0593
--------------------------------------------------
Epoch:   95,
Epoch 95:  78%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                     | 2714/3474 [05:52<01:38,  7.71it/s, loss=0.0616]Training time:  352s
Epoch 95: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3474/3474 [26:49<00:00,  2.16it/s, loss=0.0616]
                   mrr           mr   hit@1   hit@3  hit@10█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 760/760 [20:58<00:00,  1.44s/it]
tail ranking  0.655642  3970.013843  59.69%  69.02%  76.14%
head ranking  0.484647  8501.662492  45.35%  49.90%  54.94%
mean ranking  0.570145  6235.838167  52.52%  59.46%  65.54%
Ellipsis
Validation time: 1258s
Epoch 95: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3474/3474 [26:50<00:00,  2.16it/s, loss=0.0616]
Total time: 1610s, loss: 0.0591
--------------------------------------------------
Epoch:   96,
Epoch 96: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:52<00:00,  7.70it/s, loss=0.0672]Total time:  352s, loss: 0.0591
--------------------------------------------------
Epoch:   97,
Epoch 97: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:52<00:00,  7.70it/s, loss=0.0572]Total time:  352s, loss: 0.0588
--------------------------------------------------
Epoch:   98,
Epoch 98:  78%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                     | 2714/3474 [05:50<01:38,  7.73it/s, loss=0.0656]Training time:  350s
Epoch 98: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3474/3474 [26:52<00:00,  2.15it/s, loss=0.0656]
                   mrr           mr   hit@1   hit@3  hit@10█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 760/760 [21:02<00:00,  1.44s/it]
tail ranking  0.652173  3728.861239  59.76%  68.75%  75.91%
head ranking  0.484843  8629.020435  45.68%  49.77%  54.12%
mean ranking  0.568508  6178.940837  52.72%  59.26%  65.01%
Ellipsis
Validation time: 1262s
Epoch 98: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 3474/3474 [26:53<00:00,  2.15it/s, loss=0.0656]
Total time: 1613s, loss: 0.0588
--------------------------------------------------
Epoch:   99,
Epoch 99: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:54<00:00,  7.66it/s, loss=0.0569]Total time:  354s, loss: 0.0584
--------------------------------------------------
Epoch 99: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2714/2714 [05:54<00:00,  7.66it/s, loss=0.0569]
model_path: /raid/chrisjihee/proj/KG-S2S/checkpoint/WN18RR-2023-12-01 00:47:11.505860/WN18RR-epoch=074-val_mrr=0.5730.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3,4,5,6,7]
Testing: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 784/784 [22:07<00:00,  1.79s/it]                   mrr           mr   hit@1   hit@3  hit@10
tail ranking  0.680000  3500.887045  62.16%  71.89%  79.16%
head ranking  0.470856  8518.603382  43.91%  48.56%  53.32%
mean ranking  0.575428  6009.745214  53.03%  60.23%  66.24%
--------------------------------------------------------------------------------
DATALOADER:0 TEST RESULTS
{'val_mrr': 0.5754279494285583}
--------------------------------------------------------------------------------
DATALOADER:1 TEST RESULTS
{'val_mrr': 0.5754279494285583}
--------------------------------------------------------------------------------

==================================================
Epoch: test
Ellipsis
==================================================
Testing: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 784/784 [22:07<00:00,  1.69s/it]
(KG-S2S) chrisjihee@dgx-a100:~/proj/KG-S2S$

